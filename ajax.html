<head>
  <meta charset="utf-8">
  <style>
    /* CSS for popup notes  */

    #notes {
      position: fixed;
      top: 1em;
      width: 100%;
      cursor: default;
      transition: height .45s ease-in-out;
      -webkit-transition: height .45s ease-in-out;
      pointer-events: none;
      z-index: 1;
    }

    #notes .note-item {
      max-height: 12em;
      opacity: 1;
      will-change: opacity, transform;
      transition: all .2s linear;
      -webkit-transition: all .2s linear;
      backface-visibility: hidden;
      -webkit-backface-visibility: hidden;
      -moz-backface-visibility: hidden;
      -ms-backface-visibility: hidden;
      width: 50vw;
      -webkit-touch-callout: none;
      user-select: none;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      -o-user-select: none;
      z-index: 2;
      pointer-events: auto;
      display: -webkit-box;
      display: -webkit-flex;
      display: -moz-flex;
      display: -ms-flex;
      display: -ms-flexbox;
      display: flex;
      -webkit-align-content: flex-start;
      -ms-flex-line-pack: start;
      align-content: flex-start;
      -webkit-box-align: start;
      -ms-flex-align: start;
      -webkit-align-items: flex-start;
      -moz-align-items: flex-start;
      align-items: flex-start;
      -webkit-align-content: flex-start;
      -ms-flex-line-pack: start;
      align-content: flex-start;
      max-width: 20em;
      font: inherit;
      line-height: 1.25em;
      color: #fff;
      margin: 0 auto 1em auto;
      transform: translateZ(0);
      -moz-transform: translateZ(0);
      -ms-transform: translateZ(0);
      -webkit-transform: translateZ(0);
      padding: .75em 1em;
    }

    @media all and (max-width: 30em) {
      #notes .note-item {
        width: 75vw;
        max-width: none;
      }
    }

    #notes .note-item[data-show="false"] {
      pointer-events: none;
      opacity: 0 !important;
      max-height: 0 !important;
      margin-bottom: 0 !important;
    }

    #notes .note-item[data-type="info"] {
      background-color: #375e97;
    }

    #notes .note-item[data-type="warn"] {
      background-color: #ebac00;
      animation: shake 0.9s cubic-bezier(0.36, 0.07, 0.19, 0.97) both;
      -webkit-animation: shake 0.9s cubic-bezier(0.36, 0.07, 0.19, 0.97) both;
    }

    #notes .note-item[data-type="error"] {
      background-color: #fb6542;
      animation: shake 0.54s cubic-bezier(0.36, 0.07, 0.19, 0.97) both;
      -webkit-animation: shake 0.54s cubic-bezier(0.36, 0.07, 0.19, 0.97) both;
    }

    #notes .note-item[data-type="success"] {
      background-color: #3f681c;
    }

    #notes .note-item .note-item-text {
      flex: auto;
      -webkit-flex: auto;
      -moz-flex: auto;
      -ms-flex: auto;
      padding-right: .5em;
      max-width: calc(100% - 1.25em);
      max-width: -webkit-calc(100% - 1.25em);
    }

    #notes .note-item .note-item-btn {
      width: 1.25em;
      height: 1.25em;
      cursor: pointer;
      background: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48c3ZnIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiB4bWw6c3BhY2U9InByZXNlcnZlIiBmaWxsPSIjZmZmIj48cGF0aCBkPSJNMTguMyw1LjcxTDE4LjMsNS43MWMtMC4zOS0wLjM5LTEuMDItMC4zOS0xLjQxLDBMMTIsMTAuNTlMNy4xMSw1LjdjLTAuMzktMC4zOS0xLjAyLTAuMzktMS40MSwwbDAsMCBjLTAuMzksMC4zOS0wLjM5LDEuMDIsMCwxLjQxTDEwLjU5LDEyTDUuNywxNi44OWMtMC4zOSwwLjM5LTAuMzksMS4wMiwwLDEuNDFoMGMwLjM5LDAuMzksMS4wMiwwLjM5LDEuNDEsMEwxMiwxMy40MWw0Ljg5LDQuODkgYzAuMzksMC4zOSwxLjAyLDAuMzksMS40MSwwbDAsMGMwLjM5LTAuMzksMC4zOS0xLjAyLDAtMS40MUwxMy40MSwxMmw0Ljg5LTQuODlDMTguNjgsNi43MywxOC42OCw2LjA5LDE4LjMsNS43MXoiLz48L3N2Zz4=) no-repeat 0 0/contain;
      transition: opacity .2s;
      -webkit-transition: opacity .2s;
    }

    #notes .note-item .note-item-btn:hover {
      opacity: .6;
    }

    @keyframes shake {

      10%,
      90% {
        transform: translate3d(-1px, 0, 0);
        -webkit-transform: translate3d(-1px, 0, 0);
        -ms-transform: translate3d(-1px, 0, 0);
      }

      20%,
      80% {
        transform: translate3d(2px, 0 0);
        -webkit-transform: translate3d(2px, 0, 0);
        -ms-transform: translate3d(2px, 0, 0);
      }

      30%,
      50%,
      70% {
        transform: translate3d(-4px, 0, 0);
        -webkit-transform: translate3d(-4px, 0, 0);
        -ms-transform: translate3d(-4px, 0, 0);
      }

      40%,
      60% {
        transform: translate3d(4px, 0, 0);
        -webkit-transform: translate3d(4px, 0, 0);
        -ms-transform: translate3d(4px, 0, 0);
      }
    }

    @-webkit-keyframes shake {

      10%,
      90% {
        -webkit-transform: translate3d(-1px, 0, 0);
      }

      20%,
      80% {
        -webkit-transform: translate3d(2px, 0, 0);
      }

      30%,
      50%,
      70% {
        -webkit-transform: translate3d(-4px, 0, 0) t;
      }

      40%,
      60% {
        -webkit-transform: translate3d(4px, 0, 0);
      }
    }

    h3 {
      margin-bottom: .75rem;
    }

    .btn {
      transition: background-color .1s;
      -webkit-transition: background-color .1s;
      cursor: pointer;
      background-color: #f9f9f9;
      color: #7f7f7f;
      font: inherit;
      padding: .25rem 0;
      width: 4rem;
      margin: .25rem .25rem 0 0;
      text-align: center;
    }

    .btn:hover {
      background-color: #ececec;
    }

    .btn:first-child {
      margin-left: 0;
    }

    /* Style page content - use this if you want to push the page content to the right when you open the side navigation */

    #CategoryListTab {
      transition: margin-left .5s;
      padding: 20px;
    }

    /* On smaller screens, where height is less than 450px, change the style of the sidenav (less padding and a smaller font size) */

    @media screen and (max-height: 450px) {
      .sidenav {
        padding-top: 15px;
      }

      .sidenav a {
        font-size: 18px;
      }
    }



    /* https://www.w3schools.com/howto/tryit.asp?filename=tryhow_css_loader5 */
    /* Center the loader */

    #loader {
      position: fixed;
      left: 50%;
      top: 50%;
      z-index: 1;
      width: 150px;
      height: 150px;
      margin: -75px 0 0 -75px;
      border: 16px solid #f3f3f3;
      border-radius: 50%;
      border-top: 16px solid #3498db;
      width: 120px;
      height: 120px;
      -webkit-animation: spin 2s linear infinite;
      animation: spin 2s linear infinite;
    }

    @-webkit-keyframes spin {
      0% {
        -webkit-transform: rotate(0deg);
      }

      100% {
        -webkit-transform: rotate(360deg);
      }
    }

    @keyframes spin {
      0% {
        transform: rotate(0deg);
      }

      100% {
        transform: rotate(360deg);
      }
    }

    /* Add animation to "page content" */

    .animate-bottom {
      position: relative;
      -webkit-animation-name: animatebottom;
      -webkit-animation-duration: 1s;
      animation-name: animatebottom;
      animation-duration: 1s
    }

    @-webkit-keyframes animatebottom {
      from {
        bottom: -100px;
        opacity: 0
      }

      to {
        bottom: 0px;
        opacity: 1
      }
    }

    @keyframes animatebottom {
      from {
        bottom: -100px;
        opacity: 0
      }

      to {
        bottom: 0;
        opacity: 1
      }
    }



    .menubutton {
      color: white;
      border: none;
      cursor: pointer;
    }

    .menubutton:hover,
    .menubutton:focus {
      background-color: #dddddd;
      transition: 1.5s;
    }

    .menubutton:active {
      background-color: #eeeeee;
      transition: 0.5s;
    }

    .menubutton:not(:last-child) {
      //  transition: 1.5s;
    }

    .menubutton:not(:hover),
    .menubutton:not(:focus) {
      transition: 1.5s;
    }

    //Dropdown menu
    .dropbtn {
      //Button for dropdown menu
    }

    .dropdown {
      position: relative;
      display: inline-block;
    }

    .dropdown-content {
      display: none;
      position: absolute;
      background-color: #f1f1f1;
      min-width: 160px;
      overflow: auto;
      box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2);
      z-index: 1;
    }

    .dropdown-content a {
      color: black;
      padding: 12px 16px;
      text-decoration: none;
      display: block;
    }

    .dropdown a:hover {
      background-color: #ddd;
    }

    .show {
      display: block;
    }


    .menudesc {
      font-size: 40%;
      //      font-size: 0.5vw;
    }

    // Tables

    .divTableBody {
      display: table;
      margin: 0 auto;
      width: auto;
    }

    .divTableRow {
      display: table-row;
    }

    .divTableCell {
      display: table-cell;
      word-wrap: break-word;
    }

    .divMenuCell {
      display: inline-block;
      text-align: center;
      word-wrap: break-word;
    }

    .divTableFuncListRow {
      display: table-row;
      margin: 0 auto;
    }


    .funcTable {
      display: table;
      margin: 0 auto;
      width: auto;
    }

    .funcRow {
      display: table-row;
      //      border: 5px dotted red;
      //      border: 10px solid transparent;
    }

    .funcCell {
      display: table-cell;
      border: 5px solid transparent;
      text-align: start;
      word-wrap: break-word;
      //    outline: 1px dotted blue;
      vertical-align: middle;
    }

    .rootCell {
      display: table-cell;
      border: 5px solid transparent;
      text-align: start;
      white-space: nowrap;
      //    outline: 1px dotted blue;
      vertical-align: middle;
    }


    //    *[id^='menurubberimage'] {}

    .topMenuImage {
    //  width: 8vw;
    }


    .centered {
      vertical-align: middle;
    }

    .printResultTab {
      display: none;
      text-align: center;
    }

    .textBtnGroup button {
      //  background-color: #4CAF50; /* Green background */
      border: 1px solid lightblue;
      /* Blue border */
      //      color: white; /* White text */
      padding: 5px 12px;
      /* Some padding */
      cursor: pointer;
      /* Pointer/hand icon */
      width: 100%;
      /* Set a width if needed */
      display: block;
      /* Make the buttons appear below each other */
    }

    .textBtnGroup button:not(:last-child) {
      border-bottom: none;
      /* Prevent double borders */
    }

    /* Add a background color on hover */
    .textBtnGroup button:hover,
    button:focus {
      transition: 1.5s;
      background-color: #dddddd;
      //  background-color: #3e8e41;
    }

    .textBtnGroup button:not(:hover),
    button:not(:focus) {
      transition: 1.5s;
    }

    .okCancelIcons {
      opacity: 0.33;
    }

    @media (max-width: 1200px) {
      .hideme {
        display: none;
      }

      .topMenuImage {
  //      width: 12vw;
      }
    }

    .Management4HomePage {
      width: 50%;
      max-width: 100%;
      display: inline-block;
    }

    @media (max-width: 1000px) {
      .Management4HomePage {
        display: block;
        border: 10px solid transparent;
        width: 100%;
      }
    }

    .MarkErrors {
      background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABmJLR0QA/wD/AP+gvaeTAAADhklEQVRoge2ZT2wMURzHv9+ZLTHbpf4dpMQNV5n+iUQTViNEJCJagoiDAykOThIklUhdRdMlEicOiESkJISthkizrd5xERSJpA66ndXanZ+DCmZmd+bNzk4k+rnte++37/PdN9l58waYZZb/G0bxJdLRoRe+vG0RYCOEplDWgFgGQf3MLHkIPlL4SogXGvFk3vrcMLthVzt3VQGszc0rbJtdEOwH0KhYPgbhdc1GnzGYGwvrECrAxNa1SzGdOEfwIIA5YSefYZqCqyXizPzs8LhqsXKAfHvLXgh6ASxSrfVhXCBdqezITZWiwAHENOvyDXqGwCF1t+AIcbm+aBzj4GAxyPhAAWS7aUxaiduAbK1OLzD3k0apk/2jlt9A3wBimnWTDYm7qvLJGw/++jy5Z4tKOQDcT5aMHX4rofl9S75Bz8T4y//JNkuzLvoNqhggv6l5X62v+UoIcWSivbmz0piyAb5ualkM8EL0WmpQmPm6wVxSrr9sAEJ6AJQtjJHFuq51l+v0DGBtaF0+c5P6JxDwkJVe53mn9wxgJ+Qoqr/DRslcm8Uurw5XAOmGBsG+2jupwgPS0aE7W10BCs9aWgEsj8VJjcbC+BvT2eheAWBjPD7q2BrTzjZXABtoikdHHQr9V4DAqnh01BHIameb17/QshhcQkKXm1eA+hhMwpJyNvhu5v51vALkY7cIzoSzwSvApxhEQiIuN/e/kPBVPDLqkHzpbHOvAGU0FpsQiA2Xm3sFyIF4dNQhxeXmCjBvfW4YwPtYjNR4Z7SNuFbA86E+n249D8rJ2jsFR4CeVHb4lLPd8z6g2egDMF1zq+BM6aJnvDo8AxiDuTEKrtbWKTgUXDEGhj549SXKFRXr9NP699IuEEvDTBrBudAvxkvE2XKdZbcSCx4OfRHyeNhZo0LAw5UOfSvuhVLZ3A0hLkevFQwKelPZ3O1KY3w3c/ULVx4V4E50WoG5Z9jGCb9BCoe7+i0A26rWCkZ/0tJ3c2io4Dcw0Haa/aNWsmTsoOBS9W4+cwl6kyVjZxB5IMQLjon25k4K+xD9qd1nAbv8rnknyg80qccjt0oJfTUhfQCmVOs9+EZBb3FqzhpVeaDal3zpdY0/T8y4H8AKxfJ3QlzTWJdJPnr+MaxDNK9Zu6EVnjY12RrTFJo/Tw/YiN/P13kAYwRei+AFKQNG28hoFK9ZZ5nlf+cHh2YMk/LEzMEAAAAASUVORK5CYII=) no-repeat 0 0/contain;
      width: 16px;
      height: 16px;
    }

    .verticalMenu {
      position: fixed;
      margin: 0 auto;
    }
    @media (max-height: 640px) {
      .verticalMenu {
        position: relative;
        margin: 0 auto;
      }
    }
  </style>
  <title>BSB-LAN Web AJAX</title>
</head>

<body onload="InterfaceInit();">
  <div id="loader"></div>
  <!-- HTML Formatter: https://serblog.ru/demo/format-html/ -->
  <script type="text/javascript">
    function gemById(element) {
      return document.getElementById(element);
    }

    function ShowLoader(flag) {
      if (flag)
        gemById("loader").style.display = "inline";
      else
        gemById("loader").style.display = "none";
    }
    ShowLoader(true);

    var clockImage = new Image().src =
      "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHg9IjBweCIgeT0iMHB4Igp3aWR0aD0iOTYiIGhlaWdodD0iOTYiCnZpZXdCb3g9IjAgMCA0OCA0OCIKc3R5bGU9IiBmaWxsOiMwMDAwMDA7Ij48cGF0aCBmaWxsPSIjMDBhY2MxIiBkPSJNNDQsMjRjMCwxMS4wNDQtOC45NTYsMjAtMjAsMjBTNCwzNS4wNDQsNCwyNFMxMi45NTYsNCwyNCw0UzQ0LDEyLjk1Niw0NCwyNHoiPjwvcGF0aD48cGF0aCBmaWxsPSIjZWVlIiBkPSJNNDAsMjRjMCw4LjgzOC03LjE2MiwxNi0xNiwxNlM4LDMyLjgzOCw4LDI0UzE1LjE2Myw4LDI0LDhTNDAsMTUuMTYzLDQwLDI0eiI+PC9wYXRoPjxwYXRoIGQ9Ik0yMyAxMUgyNVYyNEgyM3oiPjwvcGF0aD48cGF0aCBkPSJNMjYuMDgyIDIyLjY1NEgyOC40MTlWMzEuODQ2SDI2LjA4MnoiIHRyYW5zZm9ybT0icm90YXRlKC00NS4wMDEgMjcuMjUgMjcuMjUpIj48L3BhdGg+PHBhdGggZD0iTTI3LDI0YzAsMS42NTctMS4zNDQsMy0zLDNjLTEuNjU3LDAtMy0xLjM0My0zLTNzMS4zNDMtMywzLTNDMjUuNjU2LDIxLDI3LDIyLjM0MywyNywyNCI+PC9wYXRoPjxwYXRoIGZpbGw9IiMwMGFjYzEiIGQ9Ik0yNSwyNGMwLDAuNTUxLTAuNDQ4LDEtMSwxcy0xLTAuNDQ5LTEtMWMwLTAuNTUzLDAuNDQ4LTEsMS0xUzI1LDIzLjQ0NywyNSwyNCI+PC9wYXRoPjwvc3ZnPg==";
    var backImage = new Image().src =
      "data:image/png;base64,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";
    var cancelImage = new Image().src =
      "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHg9IjBweCIgeT0iMHB4Igp3aWR0aD0iOTYiIGhlaWdodD0iOTYiCnZpZXdCb3g9IjAgMCA0OCA0OCIKc3R5bGU9IiBmaWxsOiMwMDAwMDA7Ij48cGF0aCBmaWxsPSIjZjQ0MzM2IiBkPSJNNDQsMjRjMCwxMS4wNDUtOC45NTUsMjAtMjAsMjBTNCwzNS4wNDUsNCwyNFMxMi45NTUsNCwyNCw0UzQ0LDEyLjk1NSw0NCwyNHoiPjwvcGF0aD48cGF0aCBmaWxsPSIjZmZmIiBkPSJNMjkuNjU2LDE1LjUxNmwyLjgyOCwyLjgyOGwtMTQuMTQsMTQuMTRsLTIuODI4LTIuODI4TDI5LjY1NiwxNS41MTZ6Ij48L3BhdGg+PHBhdGggZmlsbD0iI2ZmZiIgZD0iTTMyLjQ4NCwyOS42NTZsLTIuODI4LDIuODI4bC0xNC4xNC0xNC4xNGwyLjgyOC0yLjgyOEwzMi40ODQsMjkuNjU2eiI+PC9wYXRoPjwvc3ZnPg==";
    var okImage = new Image().src =
      "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHg9IjBweCIgeT0iMHB4Igp3aWR0aD0iOTYiIGhlaWdodD0iOTYiCnZpZXdCb3g9IjAgMCA0OCA0OCIKc3R5bGU9IiBmaWxsOiMwMDAwMDA7Ij48cGF0aCBmaWxsPSIjNGNhZjUwIiBkPSJNNDQsMjRjMCwxMS4wNDUtOC45NTUsMjAtMjAsMjBTNCwzNS4wNDUsNCwyNFMxMi45NTUsNCwyNCw0UzQ0LDEyLjk1NSw0NCwyNHoiPjwvcGF0aD48cGF0aCBmaWxsPSIjY2NmZjkwIiBkPSJNMzQuNjAyLDE0LjYwMkwyMSwyOC4xOTlsLTUuNjAyLTUuNTk4bC0yLjc5NywyLjc5N0wyMSwzMy44MDFsMTYuMzk4LTE2LjQwMkwzNC42MDIsMTQuNjAyeiI+PC9wYXRoPjwvc3ZnPg==";
    var updateImage = new Image().src =
      "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHg9IjBweCIgeT0iMHB4Igp3aWR0aD0iOTYiIGhlaWdodD0iOTYiCnZpZXdCb3g9IjAgMCA0OCA0OCIKc3R5bGU9IiBmaWxsOiMwMDAwMDA7Ij48cGF0aCBmaWxsPSIjZmY2ZjAyIiBkPSJNMzEgNy4wMDJsMTMgMS42ODZMMzMuMjk2IDE5IDMxIDcuMDAyek0xNyA0MUw0IDM5LjMxNCAxNC43MDQgMjkgMTcgNDF6Ij48L3BhdGg+PHBhdGggZmlsbD0iI2ZmNmYwMCIgZD0iTTggMjRjMC04LjgzNyA3LjE2My0xNiAxNi0xNiAxLjAyNCAwIDIuMDIxLjEwNiAyLjk5Mi4yOWwuNjkzLTMuODY1QzI2LjUyNSA0LjExMiAyNS4yNjIgNC4wMDUgMjQgNC4wMDVjLTExLjA1MyAwLTIwIDguOTQ3LTIwIDIwIDAgNC44NDQgMS42ODYgOS40NzQgNC44NDQgMTMuMDUxbDMuMDM3LTIuNjI5QzkuNDY4IDMxLjYyNSA4IDI3Ljk4NyA4IDI0ek0zOS40NzMgMTEuMjY3bC0zLjE0MyAyLjUzN0MzOC42MjIgMTYuNTcyIDQwIDIwLjEyNSA0MCAyNGMwIDguODM3LTcuMTYzIDE2LTE2IDE2LTEuMDI5IDAtMi4wMzMtLjEwNi0zLjAwOC0uMjkybC0uNjc2IDMuNzcxYzEuMjYyLjIxIDIuNTI1LjMxNyAzLjY4NC4zMTcgMTEuMDUzIDAgMjAtOC45NDcgMjAtMjBDNDQgMTkuMzc1IDQyLjQyMSAxNC44NDggMzkuNDczIDExLjI2N3oiPjwvcGF0aD48L3N2Zz4=";
    var restartImage = new Image().src =
      "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHg9IjBweCIgeT0iMHB4Igp3aWR0aD0iOTYiIGhlaWdodD0iOTYiCnZpZXdCb3g9IjAgMCA0OCA0OCIKc3R5bGU9IiBmaWxsOiMwMDAwMDA7Ij48cGF0aCBmaWxsPSIjN2NiMzQyIiBkPSJNMjQgM0EyMSAyMSAwIDEgMCAyNCA0NUEyMSAyMSAwIDEgMCAyNCAzWiI+PC9wYXRoPjxwYXRoIGZpbGw9IiNkY2VkYzgiIGQ9Ik0yNCwzNi4xYy02LjYsMC0xMi01LjQtMTItMTJjMC0zLjYsMS42LTcsNC40LTkuM2wyLjUsMy4xYy0xLjgsMS41LTIuOSwzLjgtMi45LDYuMmMwLDQuNCwzLjYsOCw4LDggczgtMy42LDgtOGMwLTIuMS0wLjgtNC0yLjItNS41bDIuOS0yLjdDMzQuOCwxOCwzNiwyMSwzNiwyNC4xQzM2LDMwLjcsMzAuNiwzNi4xLDI0LDM2LjF6Ij48L3BhdGg+PHBhdGggZmlsbD0iI2RjZWRjOCIgZD0iTTEyIDEzTDIxIDEzIDIxIDIyeiI+PC9wYXRoPjwvc3ZnPg==";
    var downloadImage = new Image().src =
      "data:image/png;base64,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";
    var uploadImage = new Image().src =
      "data:image/png;base64,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";

    var excludesImage = new Image().src =
      "data:image/png;base64,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";
  </script>

  <script type="text/javascript">
    /**
    * Анонимная самовызывающаяся функция-обертка
    * @param {document} d - получает документ


    Разработка https://web3r.ru/js-css-alerts

        */
    ! function(d) {
      "use strict";
      /**
       * Полифилл для Object.assign()
       */
      Object.assign || Object.defineProperty(Object, "assign", {
        enumerable: !1,
        configurable: !0,
        writable: !0,
        value: function(e, r) {
          "use strict";
          if (null == e) throw new TypeError("Cannot convert first argument to object");
          for (var t = Object(e), n = 1; n < arguments.length; n++) {
            var o = arguments[n];
            if (null != o)
              for (var a = Object.keys(Object(o)), c = 0, b = a.length; c < b; c++) {
                var i = a[c],
                  l = Object.getOwnPropertyDescriptor(o, i);
                void 0 !== l && l.enumerable && (t[i] = o[i])
              }
          }
          return t
        }
      });
      /**
       * Полифилл для Element.remove()
       */
      "remove" in Element.prototype || (Element.prototype.remove = function() {
        this.parentNode && this.parentNode.removeChild(this)
      });
      /**
       * Основная функция.
       * @param {Object} [settings] - предвартиельные настройки
       */
      window.note = function(settings) {
        /**
         * Настройки по умолчанию
         */
        settings = Object.assign({}, {
          callback: false,
          content: "",
          time: 4.5,
          type: "info"
        }, settings);
        if (!settings.content.length) return;
        /**
         * Функция создания элементов
         * @param {String} name - название DOM-элемента
         * @param {Object} attr - объект с атрибутами
         * @param {Object} append - DOM-элемент, в который будет добавлен новый узел
         * @param {String} [content] - контент DOM-элемента
         */
        var create = function(name, attr, append, content) {
          var node = d.createElement(name);
          for (var val in attr) {
            if (attr.hasOwnProperty(val)) node.setAttribute(val, attr[val]);
          }
          if (content) node.insertAdjacentHTML("afterbegin", content);
          append.appendChild(node);
          if (node.classList.contains("note-item-hidden")) node.classList.remove("note-item-hidden");
          return node;
        };
        /**
         * Генерация элементов
         */
        var noteBox = d.getElementById("notes") || create("div", {
          "id": "notes"
        }, d.body);
        var noteItem = create("div", {
            "class": "note-item",
            "data-show": "false",
            "role": "alert",
            "data-type": settings.type
          }, noteBox),
          noteItemText = create("div", {
            "class": "note-item-text"
          }, noteItem, settings.content),
          noteItemBtn = create("button", {
            "class": "note-item-btn",
            "type": "button",
            "aria-label": "Скрыть"
          }, noteItem);
        /**
         * Функция проверки видимости алерта во viewport
         * @returns {boolean}
         */
        var isVisible = function() {
          var coords = noteItem.getBoundingClientRect();
          return (
            coords.top >= 0 &&
            coords.left >= 0 &&
            coords.bottom <= (window.innerHeight || d.documentElement.clientHeight) &&
            coords.right <= (window.innerWidth || d.documentElement.clientWidth)
          );
        };
        /**
         * Функция удаления алертов
         * @param {Object} [el] - удаляемый алерт
         */
        var remove = function(el) {
          el = el || noteItem;
          el.setAttribute("data-show", "false");
          window.setTimeout(function() {
            el.remove();
          }, 250);
          if (settings.callback) settings.callback(); // callback
        };
        /**
         * Удаление алерта по клику на кнопку
         */
        noteItemBtn.addEventListener("click", function() {
          remove();
        });
        /**
         * Визуальный вывод алерта
         */
        window.setTimeout(function() {
          noteItem.setAttribute("data-show", "true");
        }, 250);
        /**
         * Проверка видимости алерта и очистка места при необходимости
         */
        if (!isVisible()) remove(noteBox.firstChild);
        /**
         * Автоматическое удаление алерта спустя заданное время
         */
        window.setTimeout(remove, settings.time * 1000);
      };
    }(document);
  </script>

  <div id="menurubber" style="display: block; margin: 0 auto; text-align: center;">
    <!-- using Color icons from https://icons8.com/icon/pack/science/color -->
      <div class="divMenuCell" id="menurubber1cell">
        <input type="image" class="menubutton topMenuImage" id="menurubberimage1" onclick="GoHome();"
          src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHg9IjBweCIgeT0iMHB4Igp3aWR0aD0iOTYiIGhlaWdodD0iOTYiCnZpZXdCb3g9IjAgMCA0OCA0OCIKc3R5bGU9IiBmaWxsOiMwMDAwMDA7Ij48cGF0aCBmaWxsPSIjRThFQUY2IiBkPSJNNDIgMzlMNiAzOSA2IDIzIDI0IDYgNDIgMjN6Ij48L3BhdGg+PHBhdGggZmlsbD0iI0M1Q0FFOSIgZD0iTTM5IDIxTDM0IDE2IDM0IDkgMzkgOXpNNiAzOUg0MlY0NEg2eiI+PC9wYXRoPjxwYXRoIGZpbGw9IiNCNzFDMUMiIGQ9Ik0yNCA0LjNMNCAyMi45IDYgMjUuMSAyNCA4LjQgNDIgMjUuMSA0NCAyMi45eiI+PC9wYXRoPjxwYXRoIGZpbGw9IiNEODQzMTUiIGQ9Ik0xOCAyOEgzMFY0NEgxOHoiPjwvcGF0aD48cGF0aCBmaWxsPSIjMDE1NzlCIiBkPSJNMjEgMTdIMjdWMjNIMjF6Ij48L3BhdGg+PHBhdGggZmlsbD0iI0ZGOEE2NSIgZD0iTTI3LjUsMzUuNWMtMC4zLDAtMC41LDAuMi0wLjUsMC41djJjMCwwLjMsMC4yLDAuNSwwLjUsMC41UzI4LDM4LjMsMjgsMzh2LTJDMjgsMzUuNywyNy44LDM1LjUsMjcuNSwzNS41eiI+PC9wYXRoPjwvc3ZnPg=="></input>
        <br><output class="menudesc" id="menurubber1celltext"></output>
      </div>
      <div class="divMenuCell" id="menurubber2cell">
        <input type="image" class="menubutton topMenuImage" id="menurubberimage2" onclick="GoManage();"
          src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAABmJLR0QA/wD/AP+gvaeTAAAB20lEQVR4nO3asS5EQRiG4W9EuXoSmqVQUtBJ1k0oRUXlYnADLkCvQ6IiEq1CFCiUEqJ0FByEZGPmxP8dx/t0wu9s5s1Yw0gAAAAAAAD4L1LTb3B+cVkN+/z87EzjZ3T5eSNNhtEcAcwIYEYAMwKYEcCMAGYEMCOAGQHMCGA2mjtwsNBbSUlbksYl6X51bujXHy726r+l3Clpc/nkcS/7VXZY9g74vPiZxlVpu2Cu00p+BJUsfm2iwWwn8R5gRgAzApgRwIwAZtnnAEm3kiZLHpak65K5SEeLY0tStVtJfenn55wkXUlpbXD6cJzzvPxzwPPzul4j5LqpqmqjYC7Yx+JnTUl9qdrNncveAYOzp31JU+8P3tTQWwNpp/nNi0gli99klvcAMwKYEcCMAGYEMCPAF6+/z8fNEuCbtFaykPVBLHeu5CTcaW8n2en6498+57ADzAhgRgAzApgRwIwAZgQwI4AZAcwIYEYAMwKYEcCMAGYEMGv9/wOib6pF+wM7IPamWrTWB4i+qRat9QG6jgBmBDAjgBkBzFofIPqmWrTWB4i+qRat9Sfh6Jtq0f7ADug2ApgRwIwAZgQwI4AZAcwIYEYAMwKYEcCMAGYEMCOAGQEAAAAAAACAIC/d0mKocB2ZyAAAAABJRU5ErkJggg=="></input>
        <br><output class="menudesc" id="menurubber2celltext"></output>
      </div>
      <div class="divMenuCell" id="menurubber3cell">
        <input type="image" class="menubutton topMenuImage" id="menurubberimage3" onclick="LoadElement('HomePageTab', 'WT')"
          src="data:image/png;base64,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"></input>
        <br><output class="menudesc" id="menurubber3celltext"></output>
      </div>
      <div class="divMenuCell" id="menurubber4cell">
        <input type="image" class="menubutton topMenuImage" id="menurubberimage4" onclick="DisplayChart()"
          src="data:image/png;base64,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"></input>
        <br><output class="menudesc" id="menurubber4celltext"></output>
      </div>
      <div class="divMenuCell hideme" id="menurubber5cell">
        <input type="image" class="menubutton topMenuImage" id="menurubberimage5" onclick="LoadElement('HomePageTab', 'WQ')"
          src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHg9IjBweCIgeT0iMHB4Igp3aWR0aD0iOTYiIGhlaWdodD0iOTYiCnZpZXdCb3g9IjAgMCA0OCA0OCIKc3R5bGU9IiBmaWxsOiMwMDAwMDA7Ij48cGF0aCBmaWxsPSIjMzc0NzRGIiBkPSJNMzMgMTBBNiA2IDAgMSAwIDMzIDIyIDYgNiAwIDEgMCAzMyAxMHpNMTUgMTBBNiA2IDAgMSAwIDE1IDIyIDYgNiAwIDEgMCAxNSAxMHoiPjwvcGF0aD48cGF0aCBmaWxsPSIjMzc0NzRGIiBkPSJNNDYuNywyNWwtMTUuMywzSDE2LjdMMS40LDI1bDQuMy03LjljMS4xLTEuOSwzLjEtMy4xLDUuMy0zLjFoMjYuMmMyLjIsMCw0LjIsMS4yLDUuMywzLjFMNDYuNywyNXoiPjwvcGF0aD48cGF0aCBmaWxsPSIjMzc0NzRGIiBkPSJNMzggMjBBMTAgMTAgMCAxIDAgMzggNDAgMTAgMTAgMCAxIDAgMzggMjB6TTEwIDIwQTEwIDEwIDAgMSAwIDEwIDQwIDEwIDEwIDAgMSAwIDEwIDIweiI+PC9wYXRoPjxwYXRoIGZpbGw9IiMzNzQ3NEYiIGQ9Ik0yNCAyM0E1IDUgMCAxIDAgMjQgMzNBNSA1IDAgMSAwIDI0IDIzWiI+PC9wYXRoPjxwYXRoIGZpbGw9IiM1NDZFN0EiIGQ9Ik0yNCAyNkEyIDIgMCAxIDAgMjQgMzBBMiAyIDAgMSAwIDI0IDI2WiI+PC9wYXRoPjxnPjxwYXRoIGZpbGw9IiNBMEYiIGQ9Ik0zOCAyM0E3IDcgMCAxIDAgMzggMzcgNyA3IDAgMSAwIDM4IDIzek0xMCAyM0E3IDcgMCAxIDAgMTAgMzcgNyA3IDAgMSAwIDEwIDIzeiI+PC9wYXRoPjwvZz48Zz48cGF0aCBmaWxsPSIjQ0U5M0Q4IiBkPSJNNDEuNyAyNy43Yy0xLTEuMS0yLjMtMS43LTMuNy0xLjdzLTIuOC42LTMuNyAxLjdjLS40LjQtLjMgMSAuMSAxLjQuNC40IDEgLjMgMS40LS4xIDEuMi0xLjMgMy4zLTEuMyA0LjUgMCAuMi4yLjUuMy43LjMuMiAwIC41LS4xLjctLjNDNDIuMSAyOC43IDQyLjEgMjguMSA0MS43IDI3Ljd6TTEwIDI2Yy0xLjQgMC0yLjguNi0zLjcgMS43LS40LjQtLjMgMSAuMSAxLjQuNC40IDEgLjMgMS40LS4xIDEuMi0xLjMgMy4zLTEuMyA0LjUgMCAuMi4yLjUuMy43LjMuMiAwIC41LS4xLjctLjMuNC0uNC40LTEgLjEtMS40QzEyLjggMjYuNiAxMS40IDI2IDEwIDI2eiI+PC9wYXRoPjwvZz48L3N2Zz4="></input>
        <br><output class="menudesc" id="menurubber5celltext"></output>
      </div>
      <div class="divMenuCell" id="menurubber6cell">
        <input type="image" class="menubutton topMenuImage" id="menurubberimage6" onclick="LoadElement('HomePageTab', 'WC')"
          src="data:image/png;base64,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"></input>
        <br><output class="menudesc" id="menurubber6celltext"></output>
      </div>
      <div class="divMenuCell hideme " id="menurubber7cell">
        <input type="image" class="menubutton topMenuImage" id="menurubberimage7" onclick="LoadExternalElement('HomePageTab', 'https://1coderookie.github.io/BSB-LPB-LAN_EN/appendix_b.html')"
          src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAABmJLR0QA/wD/AP+gvaeTAAAFbklEQVR4nO2cS28bVRTH//akdhzb1I0fzTuRQtOqVZdteAoWbKnUj8A3YAcfAXb9Bl0hsYsIdAWLIlFKUlghAqREauIkWH7lZSd+1J4uWseZ63E8zjzO8cz97W6iGV2f38zxvefMGJBIJBKJRCLxIj6zJ3iwWlWtmIhj+PD153eCX1JPo4WfegKOo+KLB8+qX1FPo4X3BACsJHhGwK2rwkdlIsEzAhYSCksJnhEA8JTgKQEAPwmeEwDwkuBJAQAfCZ4VAPCQ4GkBAL0EzwsAaCVIAW+gkiAFnIFCghQg4LQEKUAHJyVIAV1wSoIUcA5OSJACemC3BCnAAHZKkAIM0k2C2fNKAX2gK8EkQ5aejTFLf9Wpp6CLvAOIkQKIkQKIcdV3wMFxHd/+nMb8eBg3pqKYjI/AZ/rZP3tx1R2wlT3GfrmOP/7bxzeP0/h+9X/qKfXEZQJONONULEg0E+O4SkC6UNaMp5MhopkYxzUC9kp1HJRfno4DQ36MxYYJZ2QM1whI548146lECIqf+TcwXCRgK6sVMJMaIZpJf7hHQE4QkOCf/wGXCNgr1XB0os3/V6/wz/+ASwSIV/90IgQ/9x3YG9gJKBzV+j5GXP9Pp8KWndtuWAnYyJTx8KcXePxnrq/jtoQV0GyqM/8/Wcvj4Y8vsL5TMjVHq2EjYCNTxtLTHTQaKlb+LRqWUDyqoXQm/wcvKUhd1u6An6zl8ctaAY2miuWVXVYSWAhY3ylh6dfXwW/x+/M9QylDzP9TQv4vHNXw9J/i6ZibBHIBG5kylld30Wi2g6/4fbi3OIF4NNDz+M2cmH606/94NID7701CUdpSOEkgFaB35beCvzAZ6Xm8qgLb4vpfp/4zPxbG/Xc7JXz32y7+Th+a+ATmIROwvlPC8or+lW8k+ABQLNVQqjROx8GAguRl/QqonoSmquKH1QypBBIBVgQfADaz2urnTI/1P0cJjguwKvgAkM5p1/8zyd71H24SHBVgZfBVFUiL+d9gAY6TBMcEWBl8AMgfVlGutvP/cEBB8i3jHTAuEhwRYHXwAb30E+q7Ac9Bgu0C7Ag+0Fl+mEnq1396QS3BVgF2BV9VgS2dO+CiUEqwVYCi+Dp+k0tVgUazaeq8+cMqTqrt+k8ooCDRR/7Xo9FQAeG3v3w+QPHbmyRsPbtdV1bH1Z8y9wCWXXeqEWz/DrBDwlZO2IAZWP93gzL4gEOrICslqCqQzlc0f7to/qcOPuDgPsAqCbkDbf4fCSqIR/vP/xyCDzi8E7ZCglj/n032n/+5BB8gqAWZlSDW/6d12o/nwSn4AFE19KISXtf/xfW/8Q0Yt+ADhP2AbhIePct07VRl9yuo1Nv1n5GggtFI764ZcH7njSr4AHFHrFunqlu7cFO4+mdTYUP5/2zDvwWH4AMMesLzY2HcuzuheZC2JUFsync8fmhg+Vk4qplqe9oNuQAAWJiMdDTO37kR1zTlm6qK7YJ4B/TegMWjAXx4K3E65hR8gIkAQJuO3r+ZwAc345r/Z/erqNba+T8yrOCKwfy/eH0UH99Osgs+wOwlvfmxMD77ZE73cRQx//dbfl68Poq3JyKGHnVxEjZ3QItuAUoL9R+9xw8vem5K2AnQo6mq2M6buwO4MhACMsUKqvV2DyESGkIscolwRtYxEALSwtU/NyCvHxlhIAR0vn4kBTiGXv6flneAc2SKFdRetvN/dGQIsbA78j8wAALE/u+cS1Y/LdgLyB5UNeNB+PmBfmC1E9bj07vjuHMthvWdEp7vlgbmBWyjsBfg8wHjoyGMj4bw0e0k9XQsh30KcjtSADFSADFSADFSADFSADFSADFSADFSgEQikUgkEomEgFfza/65Jc5AtwAAAABJRU5ErkJggg=="></input>
        <br><output class="menudesc" id="menurubber7celltext"></output>
      </div>
      <div class="divMenuCell hideme" id="menurubber8cell">
        <input type="image" class="menubutton topMenuImage" id="menurubberimage8" onclick="LoadExternalElement('HomePageTab', 'https://1coderookie.github.io/BSB-LPB-LAN_EN/toc.html')"
          src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAABmJLR0QA/wD/AP+gvaeTAAAFf0lEQVR4nO3dzW9UVRgG8Oe9n9MyLUOHjwrV2lhNjEhLisBCkaU7CW5MDGGFC9ckGjaslf+AJTGamJjIzkQTiG6IoaGlYBPB1A+gH9PpTNvpTHvvued1Ma0RaKX3zLSHwvtbNJ1775nz3vvcc+Z2FqeAEEIIIYQQQgghhBBCPA+okcajg9cGOl/quc4MBusIRIocJwJzCcA8MWpMqIAwC6YSEaaY9TSIiqxpmpjva88by+fzc006n1SKxWK7o1QPE+0jh3eCOU/k7GTGbhDvAGM7MbJMaAHQBkKONQfM7DnkBCA4E3+NHXp94OigaQ1eQ2eg8TEAEIFATgggBPM2ADsAgFfi5foPZgAggAEiBghwtEJparII4jEQjZHm3zVhWJM3lM/nfyMi3UiJzOwUi8XXHFb9DqOPHXoFzD1g6oFWeTgAgZdrJHC9yOXX/zmH5W1EBKKH7tszAIwDMB4Bt29fyTq1lvud3T3tpu+xDjNgXCXi7ymIv92+/cWZ9TSanf27gyP/A2Z6D4TjADo2qsCJP8cqnsK+V48eNRrFjmnHTrX1IwAbefEBoAOEkwy6qKNgvFSYvFQqPehe6+BS6UF3qTB5SUfBOIMugnASG3jxl2WVjw9NGxsHAOIzxm3NBABOQbm3SoXx44/uLBXGj0O5twCcWj5283B9KjZhFMDo4LUBAAOmnTYoy0xfP7qRmb4CkLVQDwAMLF+T1Nb8EB7p6+O19umrP8N59x2T/pqCiDp//OZLfmSbrXIAAPrqT9dH+vrW3P/m8PCqBaYfAZkQzpG3Ujd71jlHjgCZTPp2m9XRM8/wxkwdAB17O3Unzws6ln5aTh/Ay2s+BT73TK6N+WOoaAoJwDIJwDIJwDIJwDIJwDIJwDIJwDIJwDIJwDIJwDIJwDIJwDIJwDIJwDIJwDIJwDIJwDIJwDIJwDIJwDIJwDIJwDIJwDIJwDIJwDIJwDIJwDIJwDIJwDIJwDIJwDIJwDIJwDIJwDIJwDIJwDIJwDIJwDIJwDIJwLKGliyrVRcweOUHOA6B3PpbEQDX9eB4HhzXgeu6cF0frufBCwJ4fgDP9+D7AfwwRJBpges1tnKaqUQpRIs1xEtLiOMIKlZQcQQVRUiUQpLESJIEOtHQSiFJ1MpKZuBEQWtGx55OtGwzXyXH+Mx1kqBcmKr/rhnQ8b/7VByv1Wz1InwfYaYVQSaDsLUVrdk2tGSzCFtaG16GhpmxVKuiVqmgWpnHUrWKaHERS4vV1HWupjxdQJhpgeO6Ru2NAyhPF6CTxLT5Q1QcQ8WzWJiffWi753toy3WgrWMnduzaA89fX7kqVigVJjE/M4358gxUrJpS52pWbsSOzheM2hsFUK1UUFuoGHWYRv1CTqFUmMK9O6PI7e7Evp5eBGsslxMtLuL+2F2Upybqo3KT1KoLqC1UjKai1AHoJMFssZC6o0ZpzZiZGEe5MIXeAwcf2z9fLuHuzRtNG5VprUxFaaV+Cmrm1GNCJwn+GB15bPvYr7es17XymZhG6hHQfu78hq9VuZrzd+4g0utbwzXjujjf27vBFTXHlvk7YE+w/pUod/n+BlbSXFsmgP729Y+7gymOtW3LBHA4l8PeMHzicXvDEIdzuU2oqDm2TAAeEU53df1vCHvDEKe7uuBaXkM0DTvfARhq9zx80t2NX8pl3Jibw2QUAQA6wxD9bW04nMttqYsPNPj/AzbDSH//BTCfNWlLwOf7h4c/a3ZNzfTUT0H7h4Y+BfOFtO0Y+OKN4eFzG1FTMz31I2DFzf7+E1QP4kkP+HeZ6OyBoaHLm1FXo7ZMAABwfWDAD5LkBDG/j/rq7V3Lu+4BGHSYv6v5/uVDg4ONf80phBBCCCGEEEIIIYQQoon+AWd34AmTDxj3AAAAAElFTkSuQmCC"></input>
        <br><output class="menudesc" id="menurubber8celltext"></output>
      </div>
      <div class="divMenuCell hideme" id="menurubber9cell">
        <input type="image" class="menubutton topMenuImage" id="menurubberimage9" onclick="LoadExternalElement('HomePageTab', 'https://1coderookie.github.io/BSB-LPB-LAN_EN/chap15.html')"
          src="data:image/png;base64,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"></input>
        <br><output class="menudesc" id="menurubber9celltext"></output>
      </div>
      <div class="divMenuCell" id="menurubber12cell">
        <input type="image" class="menubutton topMenuImage" id="menurubberimage12" onclick="GoSettingsIO();"
          src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAABmJLR0QA/wD/AP+gvaeTAAAE4ElEQVR4nO2cXWhbZRjH/0/6kbRssW3aDtdkF0W2aWHtVSvYVuPQQZUhtd66C8XOKgPLBn4wENQLoS1eiF1VEAQZgojiUGZB120XzpuxlardipS2VtcPa0O7pik5jxdbtElzcs5JT/rmnDy/q/Y9b97z8v/leU/ew0kAQRAEQRAEQRAEQSgkyKhDuPPcExrTEIC6HZhPPjMDphdGvur4zs5BPUYdNKYzkPABIAjiIbsHNRQAIGj3SR1MyO4BzQgQcogIUIwIUIwIUIwIUIwIUIwIUIzhTnj49w3eiYk4hcfqSwwzs4JUgGJEgGJEgGJEgGJEgGJEgGJEgGJEgGJEgGKKczXws2d+Tfr/0+P3Zzy+06TORxVSAYoRAYoRAYqRu6EWkbuhLkMEKEYEKEb2AYqRClCMCFCMCFCM7AMsIvsAl5GzT0FuZ6a3N0xEgwBqGRio6+9/hwDLq4VUQBbMnjr1OBF9C+AAgEoC3vrj5MlBNrGkp5Kza4Bb9wENg68fYU37GoAv9RgTDdX19b1opRKkAiwQv/0PIhWBd5EmfAAg5u7Z3t73rFSCCDBJfG0Z0fkJjD/YWh+prhnT7Uh0wspyJAJMEF9bRnTuJsAamMh/o7k1lEkCMXeblSD7AAM2h78ZYo7sv3Jpxr+48IDeaxk4HezvfzvT+FIBGShemUwbPgAwkX+8pb1uJZChEoBXjM4hAnQILA6j/UojKnFLvxPhnt9aWkORQPUvOj3mjM4jAtIQWBxG49VOeOK30T7eiUqa1+3LRP4bLW3BNBKizNxjdC7ZB6TwX/hadFOrBxcPfIklrtEdj5gj+3++PO1fmG8AEGPmp4MDA+eM5lGQFbDbl/4OTPrwAUAzVwl3Ph1dBVGXmfCBAhSw21eMV4/u29KuH36COxKqomOX9cZmIu/N5tY36vr6vjE7n4ISkAg/VOVNajcOP4GGtqnuh6rWro+kORgDa88cPdxq6edsCn4fYD78zRBfCn1w8e+yQw/fbYiBta6nDreZfucnKKgKSCW78AGAqW26p/1uJWQdPlDAAgIL57MMPwFT23RP897VCx3Zhg8U6BKU/Ts/iRiALjqOrMMHXPxc0PYvuBmxJXzApUuQU8IHXCggl+FrVArYGD7gMgG5Dn+06XPYGT5QABdhO8Ofr3lSnguygt3h5wLXCnBC+IBLBTglfMCFApwUPuAyAU4LH3CRACeGD7hEgFPDB1wgwMnhAw4X4PTwAQd/P8Ab/xP3Tb22vfA9Plxr+gKL1UdsnJk1HFsBlesjKKudxWpNQ1av16gUo41nlYYPZPGFgnyBL3g/AuF5ECKYik1jha2YsPWW8nZwbAXAgzAAgOHHvtIQdpH+I+PJ5E34gEMrgH8sC8KjTSc1mquEvAofcGoFEIe3tBlXQt6FDwBFqieQDRWhhg8P3rsc9JVseWzci4oiH9a0CcRQu6k9L8MHHCrAu6dp8PzYXk/44F8oL41vOZwiIW/DBxy4BL1/+lDLrYiveHJhF176rBmLq6VbOyWWo3K6hjwOH3CggKX1kucSf+tImADjYzD3oL6sI5/DBxy4E56L+JIuwOsbRfGzV+pHX350fBAavqdwdPL/o7Ednp11HPcx9NixR5b8ZRsLe/zrP/jLY5+cePP6T6rnJAiCIAiCIAiCYIV/ARATMfHJA9YgAAAAAElFTkSuQmCC"></input>
        <br><output class="menudesc" id="menurubber12celltext"></output>
      </div>
      <div class="divMenuCell" id="menurubber10cell">
        <div class="dropdown" id="menurubber10link">
          <input type="image" id="menurubberimage10" onclick="LanguageDropDown()" class="menubutton dropbtn topMenuImage"
            src="data:image/png;base64,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"></input>
          <div id="LanguageDropdownId" class="dropdown-content"></div>
        </div>
        <br><output class="menudesc" id="menurubber10celltext"></output>
      </div>
      <div class="divMenuCell" id="menurubber11cell">
        <input type="image" class="menubutton topMenuImage" id="menurubberimage11" onclick="GoAbout();"
          src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAABmJLR0QA/wD/AP+gvaeTAAADdElEQVR4nO3cz2tUVxjG8eedOziQTKMbF9EG4pCF/gUFRZdiUyG4KbhwKTqmunVRxR/gxqUSAtm7sZsSEpEuC4r/QTfNJJJo7KoxGYOmc+/bhYpIm3jOuWd8c2aez3bOuTmc75ybOyEMQERERERERERE/UJiXGTs3ua3eTWfAPQ0VEYhMgLoYIxr7x7yBqrLIroIlblKns3+eWVgpfRVy0weu7exP89wDYJLAKplF5OYAtAHRZZdfX5hcDX0IsEBGtPrp1XlAYCh0Gv0iHWpVM62Lg4+CplcCZnUmNq4pCq/gpsPAENaFLON6Y1myGTvEzA61T4lonMAspAf2MMKEZ1oNYfmfCZ5BRi5/+ZANSv+AN/523mtKoeXJuuvXCd43YKqWXEL3Pyd7K2I3vCZ4HwCPjxqLqL/nnZ8df6RbHSlOfDCZbDzCcir+Rlw811U9xT5hOtg5wAC/T5sPf1HRcZdxzoHUMhY2HL6kTrvlc8v4eGAlfSrg64DfQLUAxbSr5z3KuiTMMWT5FPNcF1w/VgNx0fefxh/spLj7rMttNYK45X5Sy7AcF0w/+MA9tU+fYQ5eaiK7w5kGH+4idW2Gq7OX3K3oOvHap9t/kd7a4Kfj9YMVlROcgE+3nb+z4kdXtutkguwk7RuPu8lF+DJSr7ta78vb//abpVcgLvPtvD63X/f63+/Vdx5+s5gReUkF6C1VmD84SYeLXTQ3lK0txTzCx388MsmXiX2BAQk+BgKAKttxU+/vbVeRhTJnYBewwDGGMAYAxhjAGPJPQW1mjv/qb0x3f5KK4mDJ8AYAxhjAGMMYIwBjDGAMQYwxgDGGMAYAxhjAGMMYIwBjDGAMQYwxgDGGMAYAxhjAGMMYIwBjCX3XxGp/dfDl/AEGGMAYwxgjAGMMYAxBuiOddeBDNAdTt+WBTBAl8iC60gG6AKFzruOZYD4OnlemXUdzACxCWaWLw++dB3OAHGtoSq3fSYwQDyFiJ5bPF//y2cSA8SRKzDp+73RQIJ/jt6F1lTl7NJk/XHIZJ6AcB0AM6pyJHTzAZ4AH20Ay4C0FDqX55VZn6ed7XQlgApuLjW/udWNa/ea6Lcgbr6fqAG4+f6iBeDmh4kSgJsfrnQAbn45pQJw88sLDsDNjyMoADc/Hu8A3Py4vAJw8w01pjZuWq+BiIiol/wLDhTrAmYSEBUAAAAASUVORK5CYII="></input>
        <br><output class="menudesc" id="menurubber11celltext"></output>
      </div>

  </div>
  <br>
  <div id="printResult">
    <div class="printResultTab" id="AboutTab">
      About<br>
      Developed: Sergey Dukachev (mailto:github@dukess.ru)<br>
      Popup alerts: https://web3r.ru/js-css-alerts<br>
      Icons: https://icons8.com/icons/color<br>
      Loader: https://www.w3schools.com/howto/howto_css_loader.asp<br>
      DropDown list: https://www.w3schools.com/howto/howto_js_dropdown.asp<br>
      Page scrolling: https://kalapasa.ru/stati/javascript/prokrutka-stranitsy-vverkh-na-javascript/<br>
      With gratitude to my family.<br>
      In memoriam Konstantin Korneev.<br>
    </div>
    <div class="printResultTab" id='HomePageTab' style="display: block;">
      Init...
    </div>
    <div class="printResultTab" id="SaveLoadConfigTab">
      <br>
      <br><output id="SaveLoadConfigLogCat"></output>
      <br><output id="SaveLoadConfigLogFunc"></output>
      <br><output id="SaveLoadConfigLog"></output>
      <br>

      <div style="display: inline-block;">
        <div class="divMenuCell" style="float:left;" id="menurubber41cell"><input value='Download' type='image' class="menubutton" id="menurubberimage41" onclick='DownloadConfig(0, 1)'>
          <br><output class="menudesc" id="menurubber41celltext" style="display:none;"></output></div>
        <div class="divMenuCell" style="float:left;" id="menurubber42cell"><input value='Upload' type='image' class="menubutton" id="menurubberimage42" onclick='file4upload.click()'><input type="file" id="file4upload" multiple="false" hidden
            onchange='UploadConfig(this)' />
          <br><output class="menudesc" id="menurubber42celltext" style="display:none;"></output></div>
        <div class="divMenuCell" style="float:left;" id="menurubber43cell"><input value='Create excludes list' type='image' class="menubutton" id="menurubberimage43" onclick='DownloadConfig(0, 2)'>
          <br><output class="menudesc" id="menurubber43celltext" style="display:none;"></output></div>
      </div>
      <br>
      <div class="divTable" id="CategoryForSavingAndLoading" style="text-align: left;">
      </div>
    </div>
    <div class="printResultTab" id="CategoryListTab">
      <div style=" display: inline-block; width: 30%; min-width: fit-content; word-break: break-all; text-align: center;">
      <br>
      <br>
      <div id="menurubber21cell" style="display: block; margin: auto;">
        <input value='Back' type='image' class="menubutton" id="menurubberimage21" onclick='syncDateTime()'>
        <br><output class="menudesc" id="menurubber21celltext"></output>
      </div>
      <br>
      <br>
      <div id="menurubber22cell" style="display: block; margin: auto;">
        <input value='Update' type='image' class="menubutton" id="menurubberimage22" onclick='resetController();'>
        <br><output class="menudesc" id="menurubber22celltext"></output>
      </div>
    </div>
    <div id="RootTable" style="display: inline-block; width: auto; margin: auto;">
    </div>
    <div style="display: inline-block; width: 30%; min-width: 0; word-break: break-all;">
    </div>
  </div>
  <div class="printResultTab" id="CategoryContentTab">
    <div style="display: inline-block; width: 30%; min-width: 120px; word-break: break-all; text-align: center;">
      <div class="verticalMenu" style="display: block; width: 20%; min-width: 120px;">
    <br>
    <br>
    <div id="menurubber31cell" style="display: block; margin: auto;">
      <input value='Back' type='image' class="menubutton" id="menurubberimage31" onclick='ReturnToRoot()'>
      <br><output class="menudesc" id="menurubber31celltext"></output>
    </div>
    <br>
    <br>
    <div id="menurubber32cell" style="display: block; margin: auto;">
      <input value='Update' type='image' class="menubutton" id="menurubberimage32" onclick='ReloadParams();'>
      <br><output class="menudesc" id="menurubber32celltext"></output>
    </div>
    <br>
    <br>
    <div id="menurubber34cell" style="display: block; margin: auto;">
      <input value='Save' type='image' class="menubutton okCancelIcons" id="menurubberimage34" onclick='ApplyChanges();'>
      <br><output class="menudesc" id="menurubber34celltext"></output>
    </div>
    <br>
    <br>
    <div id="menurubber33cell" style="display: block; margin: auto;">
      <input value='Cancel' type='image' class="menubutton okCancelIcons" id="menurubberimage33" onclick='CancelChanges("func");'>
      <br><output class="menudesc" id="menurubber33celltext"></output>
    </div>
  </div>
</div>
  <div id="FunctionsMenuTable" style="display: inline-block; width: auto; margin: 0 auto;">
  </div>
  <div style="display: inline-block; width: 30%; min-width: 0; word-break: break-all;">
  </div>

  </div>
  </div>
  <script type="text/javascript">
    // settings
    var externaldevelop = false; //true - develop on external web server (apache); false - production on arduino web server
    var externalbaseURL = "handler.php";
    var defaultLanguage = 'ru'; // This var overrides automatic language detection
    defaultLanguage = ''; // Enable autodetection
    var textRegexp = /\b\w*_TEXT\w*\b/g; //regexp for text resources exctraction. Regexps can be tested here: https://regexr.com/
    var JSONOptionsPerRequest = 10; //1 - 200. Less: more responsive (interactive), but slower. More: faster, but less responsive
    var warnAboutExitWithoutSave = 3; //Warnings before exit from category and discard changes
    var CacheCategoriesInRAM = true; //false - Freeing RAM after exit from category
    var DatalogURL = "datalog.txt";
    var functionsListOnFrontPage = []; // Array of integers: list of functions for displaying on home page
    var monitorUpdateInterval = 60000; // update displaying values on home page every ... ms.
    var quickManageFunctionsList = []; // Array of integers: list of functions for managing on home page
    var displayWelcomeText = true; // Display short review about program functions on start page
    var hideUnsupportedParams = true; //hide unsupported params. true - hide, false - show. You can show it for debug purposes or other reason

    // internal variables
    var monitorTimerID = 0;
    var ajaxurl = document.location.pathname;
    var baseURL = ajaxurl.substr(ajaxurl.indexOf('/'), ajaxurl.lastIndexOf('/') - ajaxurl.indexOf('/') + 1);
    var ListOfChanges = {};
    var UIStrings = {};
    var langList = {};
    var warnAboutExitWithoutSaveInt = warnAboutExitWithoutSave; //internal version of warnAboutExitWithoutSave
    var CurrentCategory = null;
    var AJAXRequests = new Array();
    var FunctionsEnum = []; // JSON c перечнем параметров.
    var RootCategoryEnum = null; // JSON c перечнем категорий.
    var FunctionsListOnFrontPageFlag = false; // JSON c перечнем параметров для отображения на главной странице.
    var FunctionsquickManageListOnFrontPageFlag = false; //Флаг загрузки параметров для управления с главной страницы.
    var FlagCategoryIsLoaded = null; // Флаг загруженности категории в перечне.
    var d3libraryloaded = false;
    var configBuildStage = -1;
    var listOfNotSupportedParams = [];

    gemById("menurubberimage31").src = backImage;
    gemById("menurubberimage32").src = updateImage;
    gemById("menurubberimage33").src = cancelImage;
    gemById("menurubberimage34").src = okImage;
    gemById("menurubberimage21").src = clockImage;
    gemById("menurubberimage22").src = restartImage;
    gemById("menurubberimage41").src = downloadImage;
    gemById("menurubberimage42").src = uploadImage;
    gemById("menurubberimage43").src = excludesImage;

    function LoadScript(src, onLoadCallBack, onErrorCallBack) {
      var script = document.createElement('script');
      script.src = src;
      script.async = false;
      script.onerror = function() {
        note({
          content: "Can't load " + src,
          type: "warn",
          time: 3
        });
        if (onErrorCallBack) onErrorCallBack();
      };
      if (onLoadCallBack) script.onload = onLoadCallBack;
      document.head.appendChild(script);
    }

    function RemoveScript(filename) {
      var allsuspects = document.getElementsByTagName("script");
      for (var i = 0; i < allsuspects.length; i++) {
        if (allsuspects[i] && allsuspects[i].getAttribute("src") != null && allsuspects[i].getAttribute("src").indexOf(filename) != -1)
          allsuspects[i].parentNode.removeChild(allsuspects[i]);
      }
    }

    function translateString(instring) {
      if (typeof UIStrings[instring] === 'undefined')
        return instring;
      else
        return UIStrings[instring];
    }

    function LanguageLoad(langcode, onLoadCallBack) {
      RemoveScript('lang_' + defaultLanguage + '.js', 'js');
      RemoveScript('lang_de.js', 'js');
      // If you like English more than German, you can uncomment line below
      //                      RemoveScript('lang_en.js', 'js');
      if (langcode.length != 2) {
        // Simple language detection. Can be overrided by defaultLanguage
        var language = window.navigator.userLanguage || window.navigator.language;
        if (typeof langList[language.substring(0, 2)] === "undefined") {
          langcode = 'de';
        } else langcode = language.substring(0, 2);
      }
      if (langcode.localeCompare('de') != 0) {
        LoadScript('lang_de.js', null, null); // Full interface
        // If you like English more than German, you can uncomment line below
        // LoadScript('lang_en.js', null, null); // Less than full interface
        LoadScript('lang_' + langcode + '.js', onLoadCallBack);
      } else
        LoadScript('lang_de.js', onLoadCallBack, onLoadCallBack); // Full interface
      defaultLanguage = langcode;
    }

    function InterfaceInit() {
      // For synchronous loading of scripts (Arduino has a limit of simultaneous connections)
      LoadScript('notsupported.js', function() {
        for (var i = 0; i < listOfNotSupportedParams.length; i++) {
          if (FunctionsEnum[listOfNotSupportedParams[i]] == undefined) FunctionsEnum[listOfNotSupportedParams[i]] = {};
          FunctionsEnum[listOfNotSupportedParams[i]].error = 7;
        }
      }, null);
      LoadScript('settings.js', SettingsInit, SettingsInit);
    }

    function SettingsInit() {
      if (externaldevelop)
        baseURL = externalbaseURL;
      LoadScript('languages.js', LanguageInit, LanguageInit);
    }

    function LanguageInit() {
      LanguageLoad(defaultLanguage, LoadUIStrings);
    }

    function SetMainMenuUIString(element, id, text) {
      gemById(element + "image" + id).alt = text;
      gemById(element + id + "cell").title = text;
      gemById(element + id + "celltext").innerHTML = text;
    }

    function LoadUIStrings() {
      DisplayHomePage();
      SetMainMenuUIString("menurubber", 1, UIStrings.EXTIF_HOME_TEXT);
      SetMainMenuUIString("menurubber", 2, UIStrings.MENU_TEXT_HFK);
      SetMainMenuUIString("menurubber", 3, UIStrings.MENU_TEXT_SNS);
      SetMainMenuUIString("menurubber", 4, UIStrings.MENU_TEXT_DLG);
      SetMainMenuUIString("menurubber", 5, UIStrings.MENU_TEXT_CHK);
      SetMainMenuUIString("menurubber", 6, UIStrings.MENU_TEXT_CFG);
      SetMainMenuUIString("menurubber", 7, UIStrings.MENU_TEXT_URL);
      SetMainMenuUIString("menurubber", 8, UIStrings.MENU_TEXT_HWT);
      SetMainMenuUIString("menurubber", 9, UIStrings.MENU_TEXT_FAQ);
      SetMainMenuUIString("menurubber", 10, UIStrings.STR20_TEXT);
      SetMainMenuUIString("menurubber", 11, UIStrings.EXTIF_ABOUT_TEXT);
      SetMainMenuUIString("menurubber", 12, UIStrings.EXTIF_SAVELOAD_TEXT);
      SetMainMenuUIString("menurubber", 21, UIStrings.EXTIF_SETCLOCK_TEXT);
      SetMainMenuUIString("menurubber", 22, UIStrings.EXTIF_RESET_TEXT);
      SetMainMenuUIString("menurubber", 31, UIStrings.EXTIF_BACK_TEXT);
      SetMainMenuUIString("menurubber", 32, UIStrings.EXTIF_UPDATE_TEXT);
      SetMainMenuUIString("menurubber", 33, UIStrings.EXTIF_CANCEL_TEXT);
      SetMainMenuUIString("menurubber", 34, UIStrings.EXTIF_SAVE_TEXT);
      SetMainMenuUIString("menurubber", 22, UIStrings.EXTIF_RESET_TEXT);
      SetMainMenuUIString("menurubber", 41, UIStrings.EXTIF_DOWNLOADCONF_TEXT);
      SetMainMenuUIString("menurubber", 42, UIStrings.EXTIF_UPLOADCONF_TEXT);
      SetMainMenuUIString("menurubber", 43, UIStrings.EXTIF_DOWNLOADEXCL_TEXT);
      //If no selectLanguage selector - create it
      var elem = gemById("LanguageDropdownId");
      if (elem.innerHTML == "") {
        if (langList.length < 1)
          note({
            content: "Can't load language.js",
            type: "warn",
            time: 3
          });
        else {
          outtext = "";
          for (var j in langList) {
            outtext += `<a href="#" name="${j}" onclick="LanguageLoad('${j}', LoadUIStrings)">${langList[j]}</a>`;
          }
          elem.innerHTML = outtext;
        }
        gemById('HomePageTab').style.textAlign = "start";
      }
      LoadRootCategoryEnum();
      if (CurrentCategory != null)
        if (gemById("FunctionsMenuTable").style.display.localeCompare("none")) LoadCategoryEnum(CurrentCategory);
    }

    /* When the user clicks on the button,
    toggle between hiding and showing the dropdown content */
    function LanguageDropDown() {
      document.getElementById("LanguageDropdownId").classList.toggle("show");
    }

    // Close the dropdown if the user clicks outside of it
    window.onclick = function(event) {
      if (!event.target.matches('.dropbtn')) {
        var dropdowns = document.getElementsByClassName("dropdown-content");
        var i;
        for (i = 0; i < dropdowns.length; i++) {
          var openDropdown = dropdowns[i];
          if (openDropdown.classList.contains('show')) {
            openDropdown.classList.remove('show');
          }
        }
      }
    }

    function decimalToHex(d, padding) {
      var hex = Number(d).toString(16);
      padding = typeof(padding) === "undefined" || padding === null ? padding = 2 : padding;
      while (hex.length < padding) {
        hex = "0" + hex;
      }
      return hex;
    }

    function StackChanges(elementid, id) {
      ListOfChanges[id] = elementid;
      for (var i = 0; i < document.getElementsByClassName('okCancelIcons').length; i++)
        document.getElementsByClassName('okCancelIcons')[i].style.opacity = 1;
    }

    function ApplyChanges() {
      for (var k in ListOfChanges) {
        gameIsChanged(k);
        delete ListOfChanges[k];
      }
      for (var i = 0; i < document.getElementsByClassName('okCancelIcons').length; i++)
        document.getElementsByClassName('okCancelIcons')[i].style.opacity = 0.33;
      ListOfChanges = new Object();
    }

    function CancelChanges(prefix) {
      for (var i = 0; i < document.getElementsByClassName('okCancelIcons').length; i++)
        document.getElementsByClassName('okCancelIcons')[i].style.opacity = 0.33;
      if (prefix == "func")
        LoadValuesInCategory(CurrentCategory, 1);
      else
        loadManagementValues(quickManageFunctionsList);
      ListOfChanges = new Object();
    }

    function ReloadParams() {
      LoadValuesInCategory(CurrentCategory, 2);
    }

    function UploadConfig(fileName) {
      var reader = new FileReader();
      reader.onload = function(event) {
        var contents = JSON.parse(event.target.result);
        if (contents != null) {
          var j = 0;
          for (var k in contents) {
            while (k > RootCategoryEnum[j].max) {
              j++;
              gemById("SaveLoadConfigLogCat").textContent = UIStrings.EXTIF_CATNO_TEXT + j;
            }
            if (gemById("catrootcheckbox" + j).checked) {
              var value = contents[k].value;
              switch (contents[k].dataType) {
                case 2:
                  value = null;
                case 5:
                  if (k >= 500 && k <= 620) {
                    var val = contents[k].value.match(/(\w+|--):(\w+|--)/g);
                    if (val != null)
                      value = val[0] + "-" + val[1] + "_" + val[2] + "-" + val[3] + "_" + val[4] + "-" + val[5];
                  } else
                    value = null;
                  //value = value.replace(/\s/g,"_");
                  break;
                default:
                  break;
              }
              if (value != null) {
                gemById("SaveLoadConfigLogFunc").textContent = UIStrings.EXTIF_FUNCNO_TEXT + k;
                loadAjax(baseURL, 'WS' + k + '=' + value, uploadParamNotify, null, false);
              }
            }
          }
        }
      };

      reader.onerror = function(event) {
        console.error(UIStrings.EXTIF_CANTREADFILE_TEXT + " " + event.target.error.code);
      };
      if (fileName.files[0]) {
        reader.readAsText(fileName.files[0]);
      }
    }

    function uploadParamNotify(jsontext, command) {
      var res = command.split("=");
      note({
        content: UIStrings.EXTIF_CHANGEPARAM1_TEXT + " " + res[0].slice(1) + " " + UIStrings.EXTIF_CHANGEPARAM2_TEXT + " " + res[1] + " " + UIStrings.EXTIF_CHANGEPARAM3_TEXT,
        type: "info",
        time: 3
      });
    }


    function DownloadConfig(stage, variant) {
      switch (stage) {
        case 0:
          configBuildStage = -1;
          for (var k = 0; k < RootCategoryEnum.length; k++) {
            if (gemById("catrootcheckbox" + k).checked) {
              if (FlagCategoryIsLoaded[k]) {
                catlistload4configdump(null, 'JK=' + k, variant);
              } else {
                loadAjax(baseURL, 'JK=' + k, catlistload4configdump, variant, true);
                configBuildStage = k;
              }
            }
          }
          if (configBuildStage == -1) DownloadConfig(1, variant);
          break;
        case 1:
          configBuildStage = -1;
          var cmdlist = "";
          var j = 0;
          for (var k = 0; k < RootCategoryEnum.length; k++) {
            if (gemById("catrootcheckbox" + k).checked) {
              for (var i = RootCategoryEnum[k].min; i <= RootCategoryEnum[k].max; i++) {
                if (FunctionsEnum[i] != null && !('value' in FunctionsEnum[i])) {
                  if (variant == 1 && (FunctionsEnum[i].readonly == 1 || FunctionsEnum[i].error == 7)) continue;
                  j++;
                  cmdlist += i;
                  configBuildStage = i;
                  if (j == JSONOptionsPerRequest) {
                    loadValues4BuildConfig(cmdlist, variant);
                    cmdlist = "";
                    j = 0;
                  } else
                    cmdlist += ",";
                }
              }
            }
          }
          if (j > 0) loadValues4BuildConfig(cmdlist, variant);
          if (configBuildStage == -1) DownloadConfig(2, variant);
          break;
        case 2:
          switch (variant) {
            case 1:
              BuildConfig4Download();
              break;
            case 2:
              BuildNonSupportedParametersList4Download();
              break;
          }
          break;
      }
    }

    function BuildConfig4Download() {
      var isNotFirstElement = false;
      var currentcat = 0;
      var text = "{\n";
      for (var k in FunctionsEnum) {
        if (FunctionsEnum[k].readonly) continue; //do not save read-only parameters
        if (FunctionsEnum[k].error == 7) continue; //do not save unsupported parameters
        var allowtonext = false;
        do {
          if (RootCategoryEnum[currentcat].max < k) {
            currentcat++;
            continue;
          } else {
            allowtonext = true;
            if (!gemById("catrootcheckbox" + currentcat).checked) continue;
          }
          if (isNotFirstElement) {
            text += `,\n`;
          } else {
            isNotFirstElement = true;
          }
          text += `"${k}": {\n`;
          text += `"dataType": ${FunctionsEnum[k].dataType},\n`;
          text += `"value": "${FunctionsEnum[k].value}"\n`;
          text += `}`;
        } while (!allowtonext)
      }
      text += "\n}";
      downloadAsFile("config.json", text);
    }

    function BuildNonSupportedParametersList4Download() {
      var isNotFirstElement = false;
      var currentcat = 0;
      var text = "listOfNotSupportedParams = [\n";
      for (var k in FunctionsEnum) {
        if (FunctionsEnum[k].error != 7) continue; //save only non-exist parameters
        var allowtonext = false;
        do {
          if (RootCategoryEnum[currentcat].max < k) {
            currentcat++;
            continue;
          } else {
            allowtonext = true;
            if (!gemById("catrootcheckbox" + currentcat).checked) continue;
          }
          if (isNotFirstElement) {
            text += `,\n`;
          } else {
            isNotFirstElement = true;
          }
          text += `${k},\n`;
        } while (!allowtonext)
      }
      text += "\n]";
      downloadAsFile("notsupported.js", text);
    }

    function downloadAsFile(fileName, data) {
      let a = document.createElement("a");
      let file = new Blob([data], {
        type: 'application/json'
      });
      a.href = URL.createObjectURL(file);
      a.download = fileName;
      a.click();
      a.remove();
    }

    function rootlistshow(jsontext, command) {
      if (jsontext != null && RootCategoryEnum == null) {
        var i = 0;
        for (var k in jsontext) {
          i++;
        }
        RootCategoryEnum = new Array(i);
        i = 0;
        for (var k in jsontext) {
          RootCategoryEnum[i++] = jsontext[k];
        }
        FlagCategoryIsLoaded = new Array(i);
      }

      var outtext = `<br><h2 align="center">${UIStrings.MENU_TEXT_HFK}</h2><br><div style="display: flex; float: left;">`;
      var splittabletext = `<div class="funcTable textBtnGroup">`;
      var outtext1 =
        `<br><h2 align="center">${UIStrings.MENU_TEXT_HFK}</h2><br>` + splittabletext +
        `<div class="funcRow"><div class="rootCell"></div><div class="rootCell"><label><input id="catrootcheckboxall" type="checkbox" checked onchange="for (var i = 0; i < RootCategoryEnum.length; i++) {gemById('catrootcheckbox' + i).checked = gemById('catrootcheckboxall').checked;}"></label></div><div class="rootCell"><button onclick="gemById('catrootcheckboxall').checked=!gemById('catrootcheckboxall').checked; gemById('catrootcheckboxall').onchange();">${UIStrings.EXTIF_ALLCAT_TEXT}</button></div><div class='rootCell centered'>` +
        RootCategoryEnum[0].min + " - " + RootCategoryEnum[RootCategoryEnum.length - 1].max + `</div></div>`;
      outtext += splittabletext;
      // two columns
      //        splittabletext=`</div>` + splittabletext;
      for (var i = 0; i < RootCategoryEnum.length; i++) {
        /*        if(i > RootCategoryEnum.length/2) {
                  outtext += splittabletext;
                  splittabletext = "";
                }
        */
        outtext += `<div class="funcRow"><div class="rootCell">${i}.</div><div class="rootCell"><button onclick="LoadCategoryEnum(${i});">` + translateString(RootCategoryEnum[i].name) +
          "</button></div><div class='rootCell'></div><div class='rootCell centered'>" + RootCategoryEnum[i].min + " - " + RootCategoryEnum[i].max + "</div></div>";
        outtext1 +=
          `<div class="funcRow"><div class="rootCell">${i}.</div><div class="rootCell"><label><input id="catrootcheckbox${i}" type="checkbox" checked></label></div><div class="rootCell"><button onclick="gemById('catrootcheckbox${i}').checked=!gemById('catrootcheckbox${i}').checked">` +
          translateString(RootCategoryEnum[i].name) + `</button></div><div class='rootCell centered'>` + RootCategoryEnum[i].min + " - " + RootCategoryEnum[i].max + `</div></div>`;
      }
      outtext += "</div></div>";
      outtext1 += "</div>";
      gemById("RootTable").innerHTML = outtext;
      gemById("CategoryForSavingAndLoading").innerHTML = outtext1;
    }

    function configpageshow(htmltext, command) {
      var matchresult = htmltext.match(textRegexp);
      if (matchresult != null) {
        for (var k in matchresult) {
          var temp;
          if (typeof UIStrings[matchresult[k]] === 'string')
            htmltext = htmltext.replace(matchresult[k], UIStrings[matchresult[k]]);
        }
      }
      gemById('HomePageTab').innerHTML = htmltext;
    }

    function insertinterfaceelement(func, prefix) {
      var jsonObject = FunctionsEnum[func];
      var dataType = jsonObject.dataType;
      var multiple = "multiple";
      var outtext = "";
      outtext += `<div class="funcCell" id="${prefix}${func}text"></div><div class="funcCell" id="${prefix}${func}space"></div><div class="funcCell" id="${prefix}${func}value">`;
      switch (dataType) {
        case 0: // number
          outtext += `<input id="${prefix}${func}control" type="number" step="0.1" onChange="StackChanges(this, ${func});" value="">&nbsp;<output id="${prefix}${func}unit"></output>`;
          break;
        case 1: // enum
          multiple = "";
        case 2: // multiple choices enum (bitwise flags)
          outtext += `<select id="${prefix}${func}control" onChange="StackChanges(this, ${func});" ${multiple}>`;
          for (var j in jsonObject.possibleValues) {
            outtext += `<option value="${jsonObject.possibleValues[j].enumValue}"></option>`;
          }
          outtext += `</select>`;
          break;
        case 3: // weekday
          outtext += `<select id="${prefix}${func}control" onChange="StackChanges(this, ${func});">`;
          for (var j = 1; j <= 7; j++) {
            var temp = translateString("STR_" + (499 + j) + "_TEXT");
            outtext += `<option value="${j}">${temp}</option>`;
          }
          outtext += `</select>`;
          break;
        case 4: //time
          outtext += `<input type="time" id="${prefix}${func}control" onChange="StackChanges(this, ${func});">`;
          break;
        case 5: //date and time
          if (func >= 500 && func <= 620) {
            outtext +=
              `1. <input type="time" id="${prefix}${func}control-0" onChange="StackChanges(this, ${func});"> - <input type="time" id="${prefix}${func}control-1" onChange="StackChanges(this, ${func});">&nbsp;2. <input type="time" id="${prefix}${func}control-2" onChange="StackChanges(this, ${func});"> - <input type="time" id="${prefix}${func}control-3" onChange="StackChanges(this, ${func});">&nbsp;3. <input type="time" id="${prefix}${func}control-4" onChange="StackChanges(this, ${func});"> - <input type="time" id="${prefix}${func}control-5" onChange="StackChanges(this, ${func})">`;
          } else
            outtext += `<output id="${prefix}${func}control"></output>`;
          break;
        case 6: //day and month
          outtext += `<select id="${prefix}${func}control-d" onChange="StackChanges(this, ${func});">`;
          outtext += `<option value="0">--</option>`;
          for (var j = 1; j <= 31; j++) {
            outtext += `<option value="${j}">${(j<10)?("0"+j):(j)}</option>`;
          }
          outtext += `</select>.`;
          outtext += `<select id="${prefix}${func}control-m" onChange="StackChanges(this, ${func});">`;
          outtext += `<option value="0">--</option>`;
          for (var j = 1; j <= 12; j++) {
            outtext += `<option value="${j}">${(j<10)?("0"+j):(j)}</option>`;
          }
          outtext += `</select>`;
          break;
        case 7: //string
          outtext += `<input type="text" id="${prefix}${func}control" onChange="StackChanges(this, '${func}');">`;
          break;
        case 8: // weekday, time hh:mm
          outtext += `<select id="${prefix}${func}control-d" onChange="StackChanges(this, '${func}');">`;
          for (var j = 1; j <= 7; j++) {
            var temp;
            if (typeof UIStrings["STR_" + (499 + j) + "_TEXT"] === 'string')
              temp = UIStrings["STR_" + (499 + j) + "_TEXT"];
            else
              temp = "STR_" + (499 + j) + "_TEXT";
            outtext += `<option value="${j}">${temp}</option>`;
          }
          outtext += `</select>`;
          outtext += `<input type="time" id="${prefix}${func}control-t" onChange="StackChanges(this, '${func}');">`;
          break;
        case 99: // string with unit name. Hack.
          outtext += `<input id="${prefix}${func}control" onChange="StackChanges(this, ${func});" value="">&nbsp;<output id="${prefix}${func}unit"></output>`;
          break;
        default:
          break;
      }
      outtext += `</div>`;
      return outtext;
    }

    function insertinterfacevalues(func, prefix) {
      var jsonObject = FunctionsEnum[func];
      gemById(prefix + func + "text").innerHTML = func + ". " + translateString(jsonObject.name);
      switch (jsonObject.dataType) {
        case 0:
          gemById(prefix + func + "unit").innerHTML = translateString(jsonObject.unit);
          break;
        case 1:
        case 2:
          //slower, but recognize additional symbols in `desc` field
          for (var j in jsonObject.possibleValues) {
            var matchresult = jsonObject.possibleValues[j].desc.match(textRegexp);
            if (matchresult != null)
              gemById(prefix + func + "control").options[j].text = jsonObject.possibleValues[j].desc.replace(matchresult[0], translateString(matchresult[0]));
            else
              gemById(prefix + func + "control").options[j].text = jsonObject.possibleValues[j].desc;
          }
          // faster, but can't recognize strings with '?' symbols
          //              for (var j in jsonObject.possibleValues) {
          //                gemById(prefix + func + "control").options[j].text = translateString(jsonObject.possibleValues[j].desc);
          //              }

          break;
        case 4:
          break;
        case 5:
          break;
        default:
          break;
      }
      if (jsonObject.error == 7) { //param not supported
        if (hideUnsupportedParams)
          gemById(prefix + func).style.display = "none";
        else
          shadyIfError(prefix, func, jsonObject.error);
      }
    }

    function catlistloader(jsontext, command) {
      var res = command.split("=");
      if (res[0] == "JK" && res[1] >= 0) {
        if (!FlagCategoryIsLoaded[res[1]]) {
          if (jsontext != null) {
            for (var k in jsontext) {
              setFunctionsEnum(k, jsontext[k]);
            }
            FlagCategoryIsLoaded[res[1]] = true;
            return true;
          } else {
            return false;
          }
        } else {
          return true;
        }
      } else {
        note({
          content: UIStrings.EXTIF_CATNOTEXIST_TEXT,
          type: "error",
          time: 5
        });
        return false;
      }
      return false;
    }

    function catlistload4configdump(jsontext, command, variant) {
      var result = catlistloader(jsontext, command);
      var res = command.split("=");
      gemById("SaveLoadConfigLogCat").textContent = UIStrings.EXTIF_CATNO_TEXT + res[1] + ": " + (result ? UIStrings.EXTIF_OK_TEXT : UIStrings.EXTIF_FAILED_TEXT);
      if (configBuildStage == res[1]) DownloadConfig(1, variant);
    }

    function catlistshow(jsontext, command) {
      if (gemById("RootTable") == null) LoadRootCategoryEnum();
      var res = command.split("=");
      var outtext;
      var isAlreadyLoaded = false;
      if (catlistloader(jsontext, command)) isAlreadyLoaded = true;
      else return;

      //Interface generator
      outtext = `<br><h2 id='categorytitle${res[1]}'></h2><br>`;
      gemById("FunctionsMenuTable").innerHTML = "";
      outtext += `<div class="funcTable">`;
      for (var k = RootCategoryEnum[res[1]].min; k <= RootCategoryEnum[res[1]].max; k++) {
        if (FunctionsEnum[k] == null) continue;
        outtext += `<div class="divTableFuncListRow" id="func${k}">`;
        outtext += insertinterfaceelement(k, "func");
        outtext += `</div>`;
      }
      outtext += "</div>";
      gemById("FunctionsMenuTable").innerHTML = outtext;
      for (var k = RootCategoryEnum[res[1]].min; k <= RootCategoryEnum[res[1]].max; k++) {
        if (FunctionsEnum[k] == null) continue;
        if (FunctionsEnum[k].error == 7) shadyIfError("func", k, FunctionsEnum[k].error);
        insertinterfacevalues(k, "func");
        insertvalue(null, k, "func");
      }
      //        if (!isAlreadyLoaded)
      LoadValuesInCategory(res[1], 0);

      gemById("categorytitle" + res[1]).textContent = translateString(RootCategoryEnum[res[1]].name);
      if (CurrentCategory == null) CurrentCategory = 0;
      ShowSelectedMode(3);

      CurrentCategory = res[1];
      gemById("FunctionsMenuTable").style.display = "block";
    }

    function insertvaluesincatlistshow(jsontext, command) {
      for (var k in jsontext) {
        insertvalue(jsontext[k], k, "func");
      }
    }

    function insertvaluesinram(jsontext, command, variant) {
      for (var k in jsontext) {
        FunctionsEnum[k].value = jsontext[k].value;
        FunctionsEnum[k].error = jsontext[k].error;
        gemById("SaveLoadConfigLogFunc").textContent = UIStrings.EXTIF_FUNCNO_TEXT + k + ": " + UIStrings.EXTIF_OK_TEXT;
        if (k == configBuildStage) DownloadConfig(2, variant);
      }
    }

    function insertvaluesinmanagementlistshow(jsontext, command) {
      for (var k in jsontext) {
        insertvalue(jsontext[k], k, "manager");
      }
    }

    function shadyIfError(prefix, func, error) {
      if (error) {
        gemById(prefix + func + "text").style.opacity = 0.33;
        gemById(prefix + func + "space").classList.add("MarkErrors");
        gemById(prefix + func + "space").title = UIStrings.EXTIF_ERROR_TEXT + ": " + error;
        gemById(prefix + func + "value").style.opacity = 0.33;
        readonly = true;
      } else {
        gemById(prefix + func + "text").style.opacity = 1;
        gemById(prefix + func + "space").classList.remove("MarkErrors");
        gemById(prefix + func + "space").title = "";
        gemById(prefix + func + "value").style.opacity = 1;
      }
    }


    function insertvalue(currentValueObject, func, prefix) {
      var jsonObject = FunctionsEnum[func];
      // get value from cache, if exist
      if (currentValueObject == null) {
        if (typeof jsonObject.value === 'undefined') return;
        currentValueObject = jsonObject;
      } else {
        //cache current value and unit name
        jsonObject.value = currentValueObject.value;
        if (typeof currentValueObject.error === 'number') {
          jsonObject.error = currentValueObject.error;
        }
      }
      var readonly = false;
      if (typeof currentValueObject.readonly === 'number') {
        readonly = jsonObject.readonly;
      }
      var error = 0;
      if (typeof currentValueObject.error === 'number') {
        error = currentValueObject.error;
      }

      var sel = gemById(prefix + func + "control");

      shadyIfError(prefix, func, error);
      switch (jsonObject.dataType) {
        case 0:
          if (currentValueObject.value.length > 0 && isNaN(currentValueObject.value)) sel.type = "text";
          sel.value = currentValueObject.value;
          sel.readOnly = readonly;
          gemById(prefix + func + "unit").innerHTML = translateString(currentValueObject.unit);
          break;
        case 1:
          for (var i = 0; i < sel.options.length; i++) {
            if (sel.options[i].value == currentValueObject.value || (jsonObject.isswitch == 1 && sel.options[i].value != 0 && currentValueObject.value != 0)) {
              sel.options[i].value = currentValueObject.value;
              sel.options[i].selected = true;
            } else {
              sel.options[i].selected = false;
              sel.options[i].disabled = readonly;
            }
          }
          break;
        case 2:
          var bitparam = parseInt(currentValueObject.value, 2);
          bitparam = (bitparam << 8) + 255;
          for (var i = 0; i < sel.options.length; i++) {
            sel.options[i].selected = false;
            if (parseInt(sel.options[i].value) > 255) {
              if ((parseInt(sel.options[i].value) & bitparam) == parseInt(sel.options[i].value)) sel.options[i].selected = true;
              else sel.options[i].disabled = readonly;
            } else {
              if (((parseInt(sel.options[i].value) + (parseInt(sel.options[i].value) << 8)) & bitparam) != (parseInt(sel.options[i].value) + (parseInt(sel.options[i].value) << 8))) sel.options[i].selected = true;
              else sel.options[i].disabled = readonly;
            }
          }
          break;
        case 4:
          sel.value = currentValueObject.value;
          sel.readOnly = readonly;
          break;
        case 5:
          if (func >= 500 && func <= 620) {
            var matchresult = currentValueObject.value.match(/(\w+|--):(\w+|--)/g);
            if (matchresult != null) {
              for (var n in matchresult) {
                // HTML do not allow "24:00" for time input
                if (matchresult[n] == "24:00") {
                  gemById(prefix + func + "control" + "-" + n).value = "23:59";
                } else if (matchresult[n] == "--:--") {} else
                  gemById(prefix + func + "control" + "-" + n).value = matchresult[n];
                gemById(prefix + func + "control" + "-" + n).readOnly = readonly;
              }
            }
          } else {
            sel.innerHTML = currentValueObject.value;
            sel.readOnly = readonly;
          }
          break;
        case 6:
          var matchresult = currentValueObject.value.match(/(\d+|---)/g);
          if (matchresult != null) {
            if (matchresult[0] == "---" || matchresult.length < 2) {
              gemById(prefix + func + "control" + "-d").options[0].selected = true;
              gemById(prefix + func + "control" + "-m").options[0].selected = true;
            } else {
              gemById(prefix + func + "control" + "-d").options[parseInt(matchresult[0], 10)].selected = true;
              gemById(prefix + func + "control" + "-m").options[parseInt(matchresult[1], 10)].selected = true;
            }
            gemById(prefix + func + "control" + "-d").readOnly = readonly;
            gemById(prefix + func + "control" + "-m").readOnly = readonly;
          }
          break;
        case 7:
          sel.value = currentValueObject.value;
          sel.readOnly = readonly;
          break;
        default:
          break;
      }
    }

    function insertvaluesinmonitorlistshow(jsontext, command) {
      for (var k = 0; k < functionsListOnFrontPage.length; k++) {
        var outtext = "";
        var m = functionsListOnFrontPage[k];
        // get value from cache, if exist
        if (jsontext == null && command == null) {
          if (typeof FunctionsEnum[m].value === 'undefined') continue;
          jsontext = FunctionsEnum;
        } else {
          //cache current value and unit name
          FunctionsEnum[m].value = jsontext[m].value;
        }
        if (typeof FunctionsEnum[m] === "object") {
          var temp;
          switch (FunctionsEnum[m].dataType) {
            case 1:
              outtext = translateString(FunctionsEnum[m].possibleValues[jsontext[m].value].desc);
              break;
            case 2:
              var bitparam = parseInt(jsontext[m].value, 2);
              bitparam = (bitparam << 8) + 255;
              var notfirst = false;
              for (var j in FunctionsEnum[m].possibleValues) {
                temp = parseInt(FunctionsEnum[m].possibleValues[j].enumValue);
                var bitflag = false;
                if (temp > 255) {
                  if ((temp & bitparam) == temp) bitflag = true;
                } else {
                  if (((temp + (temp << 8)) & bitparam) != (temp + (temp << 8))) bitflag = true;
                }


                if (bitflag) {
                  if (notfirst) {
                    outtext += ", ";
                  } else {
                    notfirst = true;
                  }
                  outtext += translateString(FunctionsEnum[m].possibleValues[j].desc);
                }
              }
              break;
            default:
              outtext = jsontext[m].value;
              break;
          }
          gemById("monitor" + m + "value").innerHTML = outtext;
        }
      }
    }

    function LoadValuesInCategory(catnum, type) {
      //type var:
      //0 - full load
      //1 - replace changes only
      //2 - exclude changes

      var j = 0;
      var cmdlist = "";
      switch (type) {
        case 0:
          //full update
          for (var i = RootCategoryEnum[catnum].min; i <= RootCategoryEnum[catnum].max; i++) {
            if (FunctionsEnum[i] != null) {
              if (FunctionsEnum[i].error == 7) continue;
              j++;
              cmdlist += i;
              if (j == JSONOptionsPerRequest) {
                loadValues(cmdlist);
                cmdlist = "";
                j = 0;
              } else
                cmdlist += ",";
            }
          }
          for (var i = 0; i < document.getElementsByClassName('okCancelIcons').length; i++)
            document.getElementsByClassName('okCancelIcons')[i].style.opacity = 0.33;
          break;
        case 1:
          // cancel changes. Partial update
          if (Object.keys(ListOfChanges).length > 0) {
            for (var i in ListOfChanges) {
              j++;
              cmdlist += i;
              if (j == JSONOptionsPerRequest) {
                loadValues(cmdlist);
                cmdlist = "";
                j = 0;
              } else
                cmdlist += ",";
            }
          }
          for (var i = 0; i < document.getElementsByClassName('okCancelIcons').length; i++)
            document.getElementsByClassName('okCancelIcons')[i].style.opacity = 0.33;
          break;
        case 2:
          //exclude changes
          for (var i = RootCategoryEnum[catnum].min; i <= RootCategoryEnum[catnum].max; i++) {
            if (FunctionsEnum[i] != null) {
              if (FunctionsEnum[i].error == 7) continue;
              if (typeof ListOfChanges[i] === 'undefined') {
                j++;
                cmdlist += i;
              }
              if (j == JSONOptionsPerRequest) {
                loadValues(cmdlist);
                cmdlist = "";
                j = 0;
              } else
                cmdlist += ",";
            }
          }
          break;
        default:
          break;
      }
      if (j > 0) loadValues(cmdlist);
    }

    function gameIsChanged(funkid) {
      var elem = ListOfChanges[funkid];
      var setvalue = null;
      var desc = null;
      switch (FunctionsEnum[funkid].dataType) {
        case 0:
          setvalue = elem.value;
          desc = elem.value;
          break;
        case 1:
          for (var i = 0; i < elem.options.length; i++) {
            if (elem.options[i].selected == true) {
              setvalue = elem.options[i].value;
              desc = elem.options[i].text;
            }
          }
          break;
        case 2:
          break;
        case 4:
          setvalue = elem.value;
          desc = elem.value;
          break;
        case 5:
          if (funkid >= 500 && funkid <= 620) {
            var val = [];
            for (var n = 0; n < 6; n++) {
              val[n] = gemById(elem.id.substring(0, elem.id.length - 1) + n).value;
              // HTML do not allow "24:00" for time input
              if (val[n] == "23:59") {
                val[n] = "24:00";
              }
            }
            setvalue = val[0] + "-" + val[1] + "_" + val[2] + "-" + val[3] + "_" + val[4] + "-" + val[5];
            desc = "1. " + val[0] + "-" + val[1] + ", 2. " + val[2] + "-" + val[3] + " 3. " + val[4] + "-" + val[5];
          }
          //else
          //  sel.innerHTML = jsontext[k].value;
          break;
        case 6:
          var elemd = gemById(elem.id.substring(0, elem.id.length - 1) + "d");
          var elemm = gemById(elem.id.substring(0, elem.id.length - 1) + "m");
          var temp = null;
          for (var i = 0; i < elemd.options.length; i++) {
            if (elemd.options[i].selected == true) {
              if (elemd.options[i].value == 0)
                temp = "---";
              else {
                temp = (elemd.options[i].value < 10 ? "0" : "") + elemd.options[i].value + ".";
                for (var j = 0; j < elemm.options.length; j++) {
                  if (elemm.options[j].selected == true) {
                    if (elemm.options[j].value == 0)
                      temp = "---";
                    else {
                      temp += (elemm.options[j].value < 10 ? "0" : "") + elemm.options[j].value;
                      setvalue = temp;
                    }
                    break;
                  }
                }
                break;
              }
              break;
            }
          }
          setvalue = temp;
          desc = temp;
          break;
        case 7:
          setvalue = elem.value;
          desc = elem.value;
          break;
        case 99:
          setvalue = elem.value;
          desc = elem.value;
          break;
        default:
          break;
      }

      if (setvalue != null) {
        var unit;
        if (typeof FunctionsEnum[funkid].unit === "undefined")
          unit = "";
        else
          unit = " " + translateString(FunctionsEnum[funkid].unit);
        note({
          /*            content: "Изменён параметр " + funkid + " на значение " + setvalue  + unit, */
          content: UIStrings.EXTIF_CHANGEPARAM1_TEXT + " " + funkid + " (" + translateString(FunctionsEnum[funkid].name) + ") " + UIStrings.EXTIF_CHANGEPARAM2_TEXT + " " + desc + unit + " " + UIStrings.EXTIF_CHANGEPARAM3_TEXT,
          type: "info",
          time: 3
        });
        loadAjax(baseURL, 'WS' + funkid + '=' + setvalue, nullshow, null, false);
        FunctionsEnum[funkid].value = setvalue;
      }

    }

    function nullshow() {}

    function syncDateTime() {
      var datetimeNow = new Date();
      var formatted_date = ((datetimeNow.getDate() > 9) ? "" : "0") + datetimeNow.getDate() + "." + ((datetimeNow.getMonth() > 8) ? "" : "0") + (datetimeNow.getMonth() + 1) + "." + datetimeNow.getFullYear() + "_" + ((datetimeNow.getHours() > 9) ?
        "" : "0") + datetimeNow.getHours() + ":" + ((datetimeNow.getMinutes() > 9) ? "" : "0") + datetimeNow.getMinutes() + ":" + ((datetimeNow.getSeconds() > 9) ? "" : "0") + datetimeNow.getSeconds();
      loadAjax(baseURL, 'WS0=' + formatted_date, function() {
        note({
          content: UIStrings.EXTIF_SETTIME_TEXT + " :" + formatted_date,
          type: "info",
          time: 3
        });
      }, null, false);
    }

    function resetController() {
      loadAjax(baseURL, 'N', function() {
        note({
          content: UIStrings.EXTIF_RESET_TEXT,
          type: "info",
          time: 3
        });
      }, null, false);
    }

    function loadValues(functionsenum) {
      loadAjax(baseURL, 'JQ=' + functionsenum, insertvaluesincatlistshow, null, true);
    }

    function loadValues4BuildConfig(functionsenum, variant) {
      loadAjax(baseURL, 'JQ=' + functionsenum, insertvaluesinram, variant, true);
    }

    function loadMonitorValues(functionsenum) {
      var temp = "";
      if (functionsenum.length > 0) {
        if (!FunctionsListOnFrontPageFlag) {
          loadAjax(baseURL, 'JC=' + functionsenum, function(jsontext, command) {
            if (jsontext != null) {
              for (var k in jsontext) {
                setFunctionsEnum(k, jsontext[k]);
                FunctionsEnum[k].protect = true; //protect function against RAM freeing
              }
              FunctionsListOnFrontPageFlag = true;
            }
            loadMonitorValues(functionsenum);
          }, null, true);
          return;
        }
        var sel = gemById("monitorTable");
        var outtext = "";
        for (var k = 0; k < functionsenum.length; k++) {
          outtext +=
            `<div class="divTableRow"><div class="divTableCell" align="left">${functionsenum[k]}.&nbsp;</div><div class="divTableCell" align="left"><output id="monitor${functionsenum[k]}name">${translateString(FunctionsEnum[functionsenum[k]].name)}</output>:&nbsp;<output id="monitor${functionsenum[k]}value">---</output>&nbsp;<output id="monitor${functionsenum[k]}unit">${translateString(FunctionsEnum[functionsenum[k]].unit)}</output></div></div>`;
          //            outtext += `<div style="float: left;">${functionsenum[k]}.&nbsp;</div><div style="float: left;"><output id="monitor${functionsenum[k]}name">${translateString(FunctionsEnum[functionsenum[k]].name)}</output>:&nbsp;<output id="monitor${functionsenum[k]}value"></output>&nbsp;<output id="monitor${functionsenum[k]}unit"></output></div><br>`;
        }
        sel.innerHTML = outtext;
        //Show cached values
        insertvaluesinmonitorlistshow(null, null);
        //Show current values
        loadAjax(baseURL, 'JQ=' + functionsenum, insertvaluesinmonitorlistshow, null, true);
      }
    }

    function setFunctionsEnum(index, jsonObject) {
      if (FunctionsEnum[index] == undefined) FunctionsEnum[index] = new Object();
      FunctionsEnum[index].readonly = jsonObject.readonly;
      FunctionsEnum[index].dataType = jsonObject.dataType;
      FunctionsEnum[index].name = jsonObject.name;
      FunctionsEnum[index].unit = jsonObject.unit;
      FunctionsEnum[index].possibleValues = jsonObject.possibleValues;
      if ('isswitch' in jsonObject) FunctionsEnum[index].isswitch = jsonObject.isswitch;
      else FunctionsEnum[index].isswitch = 0;
    }

    function loadManagementValues(funcenum) {
      var temp = "";
      if (funcenum.length > 0) {
        if (!FunctionsquickManageListOnFrontPageFlag) {
          loadAjax(baseURL, 'JC=' + funcenum,
            function(jsontext, command) {
              if (jsontext != null) {
                for (var k in jsontext) {
                  setFunctionsEnum(k, jsontext[k]);
                  FunctionsEnum[k].protect = true; //protect function against RAM freeing
                }
                FunctionsquickManageListOnFrontPageFlag = true;
              }
              loadManagementValues(funcenum);
            }, null, true);
          return;
        }
        var sel = gemById("managementTable");
        var outtext = "";
        for (var k = 0; k < funcenum.length; k++) {
          outtext += `<div class="divTableRow">`;
          outtext += insertinterfaceelement(funcenum[k], "manager");
          outtext += `</div>`;
        }
        sel.innerHTML = outtext;

        for (var k = 0; k < funcenum.length; k++) {
          if (FunctionsEnum[funcenum[k]].error == 7) shadyIfError("manager", funcenum[k], FunctionsEnum[funcenum[k]].error);
          insertinterfacevalues(funcenum[k], "manager");
          insertvalue(null, funcenum[k], "manager");
        }

        loadAjax(baseURL, 'JQ=' + funcenum,
          insertvaluesinmanagementlistshow, null, true);
      }
      gemById("managercancelImage").src = cancelImage;
      gemById("managercancelImage").alt = UIStrings.EXTIF_CANCEL_TEXT;
      gemById("managercancelImage").title = UIStrings.EXTIF_CANCEL_TEXT;
      gemById("managerokImage").src = okImage;
      gemById("managerokImage").alt = UIStrings.EXTIF_SAVE_TEXT;
      gemById("managerokImage").title = UIStrings.EXTIF_SAVE_TEXT;
      for (var i = 0; i < document.getElementsByClassName('okCancelIcons').length; i++)
        document.getElementsByClassName('okCancelIcons')[i].style.opacity = 0.33;
    }

    function loadAjax(urlvar, cmdvar, showvar, paramforshowvar, isajaxvar) {
      AJAXRequests.push({
        url: urlvar,
        command: cmdvar,
        show: showvar,
        paramforshow: paramforshowvar,
        isajax: isajaxvar
      });
      if (AJAXRequests.length > 1) {
        //      note({ content: "AJAX queued", type: "success", time: 3 });
        return;
      }
      loadAjaxInt();
    }

    function loadAjaxInt() {
      if (AJAXRequests.length == 0) {
        //      note({ content: "AJAX queue empty", type: "info", time: 3 });
        return;
      }
      var request;
      if (window.XMLHttpRequest) {
        request = new XMLHttpRequest();
      } else if (window.ActiveXObject) {
        request = new ActiveXObject("Microsoft.XMLHTTP");
      } else {
        return;
      }
      request.onreadystatechange = function() {
        switch (request.readyState) {
          case 1:
            ShowLoader(true);
            break;
          case 4:
            if (request.status == 200) {
              if (AJAXRequests[0].isajax) {
                try {
                  AJAXRequests[0].show(JSON.parse(request.responseText), AJAXRequests[0].command, AJAXRequests[0].paramforshow);
                } catch (e) {
                  note({
                    content: UIStrings.EXTIF_JSONERROR_TEXT,
                    type: "error",
                    time: 5
                  });
                  console.log(e.message);
                  console.log(e.name);
                  console.log(e.fileName);
                  console.log(e.lineNumber);
                  console.log(e.columnNumber);
                  console.log(e.stack);
                }
              } else
                AJAXRequests[0].show(request.responseText, AJAXRequests[0].command, AJAXRequests[0].paramforshow);
            } else if (request.status == 404) {
              note({
                content: UIStrings.EXTIF_ERROR404_TEXT,
                type: "error",
                time: 5
              });
            } else
              note({
                content: UIStrings.EXTIF_ERRORREQUEST_TEXT,
                type: "error",
                time: 5
              });
            ShowLoader(false);
            AJAXRequests.shift();
            loadAjaxInt();
            break;
        }
      }
      request.onerror = function() {
        ShowLoader(false);
        AJAXRequests.shift();
        loadAjaxInt();
      };
      if (externaldevelop) {
        request.open('POST', AJAXRequests[0].url, true);
        request.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
        request.send("urri=" + AJAXRequests[0].command);
      } else {
        request.open('GET', AJAXRequests[0].url + AJAXRequests[0].command, true);
        request.setRequestHeader('Content-Type', 'application/x-www-form-url');
        request.send();
      }
    }

    function LoadCategoryEnum(catnum) {
      if (FlagCategoryIsLoaded[catnum]) {
        catlistshow(null, 'JK=' + catnum);
      } else
        loadAjax(baseURL, 'JK=' + catnum, catlistshow, null, true);
    }

    function LoadRootCategoryEnum() {
      if (RootCategoryEnum == null) {
        loadAjax(baseURL, 'JK=ALL', rootlistshow, null, true);
      } else
        rootlistshow(null, null);
    }

//Scrolling
    var timeOut;
    function goUp() {
       var top = Math.max(document.body.scrollTop,document.documentElement.scrollTop);
       if(top > 0) {
          window.scrollBy(0,-100);
          timeOut = setTimeout('goUp()',20);
       } else clearTimeout(timeOut);
    }

    function ShowSelectedMode(id) {
      clearTimeout(monitorTimerID); //disable update when Home Page is hidden or just started
      monitorTimerID = 0;

      //warnings about unsaved changes.
      if (!CheckForUnsavedChanges()) return false;

      gemById('HomePageTab').style.display = (id == 1) ? "block" : "none";
      gemById("CategoryListTab").style.display = (id == 2) ? "flex" : "none";
      gemById("CategoryContentTab").style.display = (id == 3) ? "flex" : "none";
      gemById("AboutTab").style.display = (id == 4) ? "block" : "none";
      gemById("SaveLoadConfigTab").style.display = (id == 5) ? "block" : "none";
      goUp();
      if (CurrentCategory != null) {
        gemById("FunctionsMenuTable").style.display = "none";
        //Freeing RAM
        if (!CacheCategoriesInRAM && id != 3) {
          for (var k = RootCategoryEnum[CurrentCategory].min; k <= RootCategoryEnum[CurrentCategory].max; k++) {
            if (!FunctionsEnum[k].protect)
              FunctionsEnum[k] = null;
          }
          FlagCategoryIsLoaded[CurrentCategory] = false;
          gemById("FunctionsMenuTable").innerHTML = "";
          CurrentCategory = null;
        }
      }
      return true;
    }

    function ReturnToRoot() {
      if (CheckForUnsavedChanges())
        ShowSelectedMode(2);
    }

    function CheckForUnsavedChanges() {
      if (warnAboutExitWithoutSaveInt && Object.keys(ListOfChanges).length > 0) {
        note({
          content: UIStrings.EXTIF_WARNEXIT_TEXT + " " + warnAboutExitWithoutSaveInt,
          type: "warn",
          time: 5
        });
        warnAboutExitWithoutSaveInt--;
        return false;
      } else {
        warnAboutExitWithoutSaveInt = warnAboutExitWithoutSave;
        ListOfChanges = new Object();
        return true;
      }
    }

    function LoadElement(place, command) {
      if (ShowSelectedMode(1))
        loadAjax(baseURL, command, configpageshow, null, false);
    }

    function LoadExternalElement(place, url) {
      if (ShowSelectedMode(1))
        gemById(place).innerHTML = `<object type="text/html" data="${url}" style="width: 100%; height: 89vh;"></object>`;
    }

    function GoAbout() {
      if (ShowSelectedMode(4));
    }

    function GoSettingsIO() {
      if (ShowSelectedMode(5));
    }

    function GoHome() {
      if (ShowSelectedMode(1))
        LoadUIStrings();
    }

    function GoManage() {
      ShowSelectedMode(2);
    }

    function DisplayChart() {
      if (!ShowSelectedMode(1)) return;
      var displaychartclassname = "displaychart";
      var outtext = `<A HREF='${DatalogURL}'>${UIStrings.MENU_TEXT_DTD}</A><div class="${displaychartclassname}" align="center"></div>`;
      gemById('HomePageTab').innerHTML = outtext;
      drawGraph("div." + displaychartclassname, DatalogURL);
    }

    function DisplayHomePage() {
      var outtext = displayWelcomeText ? `<b>${UIStrings.MENU_TEXT_HFK}:</b> ${UIStrings.MENU_DESC_HFK}
<br><b>${UIStrings.MENU_TEXT_CFG}:</b> ${UIStrings.MENU_DESC_CFG}
<br><b>${UIStrings.MENU_TEXT_URL}:</b> ${UIStrings.MENU_DESC_URL}<br>
` : ``;
      outtext += `<br>`;
      if (functionsListOnFrontPage.length > 0) outtext +=
        `<div class="Management4HomePage" align="center"><div align="center">${UIStrings.EXTIF_MONITOR_TEXT}</div><br><div class="divTableFuncMonitorListBody" align="center" id="monitorTable"></div></div>`;
      //      if(functionsListOnFrontPage.length > 0 && quickManageFunctionsList.length > 0) outtext += `<div class style="height:10px"></div>`;
      if (quickManageFunctionsList.length > 0) {
        outtext += `<div class="Management4HomePage" align="center"><div align="center">${UIStrings.EXTIF_MANAGEMENT_TEXT}</div><br><div class="divTableFuncMonitorListBody" align="center" id="managementTable"></div>
          <p></p>
            <div style="display:block; width:60%;">
              <div style="float:left;">
               <input value='Cancel' type='image' class="okCancelIcons" id="managercancelImage" onclick='CancelChanges("manager")'>
              </div>
              <div style="float:right;">
               <input value='Save' type='image' class="okCancelIcons" id="managerokImage" onclick='ApplyChanges()'>
              </div>
            </div>
      </div>`;
      }
      gemById('HomePageTab').innerHTML = outtext;
      if (functionsListOnFrontPage.length > 0) {
        loadMonitorValues(functionsListOnFrontPage);
      }
      if (quickManageFunctionsList.length > 0) {
        loadManagementValues(quickManageFunctionsList);
      }
      if (functionsListOnFrontPage.length > 0 || quickManageFunctionsList.length > 0) {
        if (monitorUpdateInterval < functionsListOnFrontPage.length * 300 * 2) monitorUpdateInterval = (quickManageFunctionsList.length + functionsListOnFrontPage.length) * 300 *
          2; // no reason for interval less than [double time of request to bus (~300 ms) multiplied by length of array] sec.
        if (monitorTimerID == 0) monitorTimerID = setTimeout(function ticktak() {
          loadMonitorValues(functionsListOnFrontPage);
          loadManagementValues(quickManageFunctionsList);
          monitorTimerID = setTimeout(ticktak, monitorUpdateInterval);
        }, monitorUpdateInterval);
      }
    }
  </script>

  <!--
/*
        Based on the awesome tutorials at
                https://bl.ocks.org/d3noob
                https://bl.ocks.org/larsenmtl
        Thanks a lot for your great work!
*/
//-->
  <style>
    /* set the CSS */

    path {
      stroke: steelblue;
      stroke-width: 2;
      fill: none;
    }

    .axis path,
    .axis line {
      fill: none;
      stroke: grey;
      stroke-width: 1;
      shape-rendering: crispEdges;
    }

    .legend {
      font-size: 16px;
      font-weight: bold;
      text-anchor: middle;
    }

    .grid .tick {
      stroke: lightgrey;
      opacity: 0.5;
    }

    .grid path {
      stroke-width: 0;
    }
  </style>

  <script>
    function getLocalizedMonthName(m, t) {
      var objDate = new Date();
      if (t) {
        rettype = {
          month: "long"
        };
      } else {
        rettype = {
          month: "short"
        };
      }
      objDate.setMonth(m - 1);
      return objDate.toLocaleString(defaultLanguage, rettype);
    }

    function drawGraph(elementtype, datasource) {
      if (!d3libraryloaded) {
        d3libraryloaded = true;
        // You can load the d3.js library from CDN
        //    LoadScript("http://d3js.org/d3.v3.min.js", function() {drawGraphInt(elementtype, datasource);}, function(){d3libraryloaded = false;}});
        // or load it from Arduino web server
        //    LoadScript("d3.v3.min.js", function() {drawGraphInt(elementtype, datasource);}, function(){d3libraryloaded = false;}});
        // Try to load from Arduino web server. If failed try to load d3.js library from CDN
        LoadScript("d3.v3.min.js", function() {
          drawGraphInt(elementtype, datasource);
        }, function() {
          LoadScript("http://d3js.org/d3.v3.min.js", function() {
            drawGraphInt(elementtype, datasource);
          }, function() {
            d3libraryloaded = false;
          });
        });
      } else
        drawGraphInt(elementtype, datasource);
    }

    function drawGraphInt(elementtype, datasource) {
      // Set the dimensions of the canvas / graph
      var margin = {
          top: 30,
          right: 20,
          bottom: 70,
          left: 50
        },
        width = 1000 - margin.left - margin.right,
        height = 600 - margin.top - margin.bottom;


      var customlocale = {
        "decimal": ",",
        "thousands": "\xa0",
        "grouping": [3],
        "currency": ["", ""],
        "dateTime": "%d.%m.%Y %H:%M:%S",
        "date": "%d.%m.%Y",
        "time": "%H:%M:%S",
        "periods": ["AM", "PM"],
        "days": [UIStrings.ENUM_WEEKDAY_07_TEXT, UIStrings.ENUM_WEEKDAY_01_TEXT, UIStrings.ENUM_WEEKDAY_02_TEXT, UIStrings.ENUM_WEEKDAY_03_TEXT, UIStrings.ENUM_WEEKDAY_04_TEXT, UIStrings.ENUM_WEEKDAY_05_TEXT, UIStrings.ENUM_WEEKDAY_06_TEXT],
        "shortDays": [UIStrings.STR506_TEXT, UIStrings.STR500_TEXT, UIStrings.STR501_TEXT, UIStrings.STR502_TEXT, UIStrings.STR503_TEXT, UIStrings.STR504_TEXT, UIStrings.STR505_TEXT],
        "months": [
          getLocalizedMonthName(1, 1),
          getLocalizedMonthName(2, 1),
          getLocalizedMonthName(3, 1),
          getLocalizedMonthName(4, 1),
          getLocalizedMonthName(5, 1),
          getLocalizedMonthName(6, 1),
          getLocalizedMonthName(7, 1),
          getLocalizedMonthName(8, 1),
          getLocalizedMonthName(9, 1),
          getLocalizedMonthName(10, 1),
          getLocalizedMonthName(11, 1),
          getLocalizedMonthName(12, 1)
        ],
        "shortMonths": [
          getLocalizedMonthName(1, 0),
          getLocalizedMonthName(2, 0),
          getLocalizedMonthName(3, 0),
          getLocalizedMonthName(4, 0),
          getLocalizedMonthName(5, 0),
          getLocalizedMonthName(6, 0),
          getLocalizedMonthName(7, 0),
          getLocalizedMonthName(8, 0),
          getLocalizedMonthName(9, 0),
          getLocalizedMonthName(10, 0),
          getLocalizedMonthName(11, 0),
          getLocalizedMonthName(12, 0)
        ],
      };
      d3.time.format = d3.locale(customlocale).timeFormat;

      // Parse the date / time
      var parseDate = d3.time.format("%d.%m.%Y %H:%M:%S").parse;

      // Set the ranges
      var x = d3.time.scale().range([0, width]);
      var y = d3.scale.linear().range([height, 0]);

      // Define the axes
      var axisTimeFormat = d3.time.format.multi([
        [".%L", function(d) {
          return d.getMilliseconds();
        }],
        [":%S", function(d) {
          return d.getSeconds();
        }],
        ["%H:%M", function(d) {
          return d.getMinutes();
        }],
        ["%H:%M", function(d) {
          return d.getHours();
        }],
        ["%d.%m", function(d) {
          return d.getDay() && d.getDate() != 1;
        }],
        ["%m.%Y", function(d) {
          return d.getDate() != 1;
        }],
        ["%B", function(d) {
          return d.getMonth();
        }],
        ["%Y", function() {
          return true;
        }]
      ]);

      var xAxis = d3.svg.axis().scale(x)
        .orient("bottom").ticks(5)
        .tickFormat(axisTimeFormat);

      var yAxis = d3.svg.axis().scale(y)
        .orient("left").ticks(5);

      // Define the line
      var priceline = d3.svg.line()
        .x(function(d) {
          return x(d.Date);
        })
        .y(function(d) {
          return y(d.Value);
        });

      // Get the data
      var dsv = d3.dsv(";", "text/plain");
      dsv(datasource, function(data) {

        data.forEach(function(d) {
          d.Date = parseDate(d.Date);
          d.Value = +d.Value;
        });

        // Scale the range of the data
        x.domain(d3.extent(data, function(d) {
          return d.Date;
        }));
        y.domain([d3.min(data, function(d) {
          if (d.Value < 0) return Math.floor(d.Value / 5) * 5;
          else return Math.ceil(d.Value / 5) * 5;
        }), d3.max(data, function(d) {
          if (d.Value < 0) return Math.floor(d.Value / 5) * 5;
          else return Math.ceil(d.Value / 5) * 5;
        })]);

        // Nest the entries by symbol
        var dataNest = d3.nest()
          .key(function(d) {
            return d.Description;
          })
          .entries(data);

        // Adds the svg canvas
        var svg = d3.select(elementtype)
          .append("svg")
          .attr("width", width + margin.left + margin.right)
          .attr("height", height + margin.top + margin.bottom + dataNest.length / 4 * 15)
          .append("g")
          .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

        var color = d3.scale.category10(); // set the colour scale

        legendSpace = width / dataNest.length; // spacing for the legend

        // Add the X Axis
        svg.append("g")
          .attr("class", "x axis")
          .attr("transform", "translate(0," + height + ")")
          .call(xAxis);

        // Add the Y Axis
        svg.append("g")
          .attr("class", "y axis")
          .call(yAxis);

        // Add the X Grid
        svg.append("g")
          .attr("class", "grid")
          .attr("transform", "translate(0," + height + ")")
          .call(xAxis.tickSize(-height, 0, 0)
            .tickFormat(""));

        // Add the Y Grid
        svg.append("g")
          .attr("class", "grid")
          .call(yAxis.ticks(10).tickSize(-width, 0, 0)
            .tickFormat(""));

        // Loop through each symbol / key
        dataNest.forEach(function(d, i) {

          svg.append("path")
            .attr("class", "line")
            .style("stroke", function() { // Add the colours dynamically
              return d.color = color(d.key);
            })
            .attr("id", 'tag' + d.key.replace(/\\s+/g, '')) // assign ID
            .attr("d", priceline(d.values));

          // Add the Legend
          svg.append("text")
            .attr("x", (margin.left + legendSpace / 2 + (i % 4) * width / 4)) // space legend
            .attr("y", height + (margin.bottom / 2) + 5 + Math.floor(i / 4) * 20)
            .attr("class", "legend") // style the legend
            .style("fill", function() { // Add the colours dynamically
              return d.color = color(d.key);
            })
            .on("click", function() {
              // Determine if current line is visible
              var active = d.active ? false : true,
                newOpacity = active ? 0 : 1;
              // Hide or show the elements based on the ID
              d3.select("#tag" + d.key.replace(/\\s+/g, ''))
                .transition().duration(100)
                .style("opacity", newOpacity);
              // Update whether or not the elements are active
              d.active = active;
            })
            //                      .text(d.key);
            .text(translateString(d.key));
        });


        var mouseG = svg.append("g")
          .attr("class", "mouse-over-effects");

        mouseG.append("path") // this is the black vertical line to follow mouse
          .attr("class", "mouse-line")
          .style("stroke", "black")
          .style("stroke-width", "1px")
          .style("opacity", "0");

        var lines = document.getElementsByClassName('line');

        var mousePerLine = mouseG.selectAll('.mouse-per-line')
          .data(dataNest)
          .enter()
          .append("g")
          .attr("class", "mouse-per-line");

        mousePerLine.append("circle")
          .attr("r", 7)
          .attr("id", function(d) {
            return 'tag' + d.key.replace(/\\s+/g, '') // assign ID
          })
          .style("stroke", function(d) {
            return color(d.key);
          })
          .style("fill", "none")
          .style("stroke-width", "1px")
          .style("opacity", "0");

        mousePerLine.append("text")
          .attr("id", function(d) {
            return 'tag' + d.key.replace(/\\s+/g, '') // assign ID
          })
          .attr("transform", "translate(10,3)");

        mouseG.append('svg:rect') // append a rect to catch mouse movements on canvas
          .attr('width', width) // can't catch mouse events on a g element
          .attr('height', height)
          .attr('fill', 'none')
          .attr('pointer-events', 'all')
          .on('mouseout', function() { // on mouse out hide line, circles and text
            d3.select(".mouse-line")
              .style("opacity", "0");
            d3.selectAll(".mouse-per-line circle")
              .style("opacity", "0");
            d3.selectAll(".mouse-per-line text")
              .style("opacity", "0");
          })
          .on('mouseover', function() { // on mouse in show line, circles and text
            d3.select(".mouse-line")
              .style("opacity", "1");
            d3.selectAll(".mouse-per-line circle")
              .style("opacity", function(d) {
                return d.active ? 0 : 1;;
              });
            d3.selectAll(".mouse-per-line text")
              .style("opacity", function(d) {
                return d.active ? 0 : 1;;
              });
          })
          .on('mousemove', function() { // mouse moving over canvas
            var mouse = d3.mouse(this);
            d3.select(".mouse-line")
              .attr("d", function() {
                var d = "M" + mouse[0] + "," + height;
                d += " " + mouse[0] + "," + 0;
                return d;
              });

            d3.selectAll(".mouse-per-line")
              .attr("transform", function(d, i) {
                var xDate = x.invert(mouse[0]),
                  bisect = d3.bisector(function(d) {
                    return d.Date;
                  }).right;
                idx = bisect(d.values, xDate);

                var beginning = 0,
                  end = lines[i].getTotalLength(),
                  target = null;

                while (true) {
                  target = Math.floor((beginning + end) / 2);
                  pos = lines[i].getPointAtLength(target);
                  if ((target === end || target === beginning) && pos.x !== mouse[0]) {
                    break;
                  }
                  if (pos.x > mouse[0]) end = target;
                  else if (pos.x < mouse[0]) beginning = target;
                  else break; //position found
                }

                outputFormat = d3.time.format("%d.%m %H:%M:%S");
                d3.select(this).select('text')
                  .text(d.values[idx].Value + " (" + outputFormat(d.values[idx].Date) + ")");

                return "translate(" + mouse[0] + "," + pos.y + ")";
              });
          });

      });
    }
  </script>

</body>
